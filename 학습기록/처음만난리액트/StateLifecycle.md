# State and Lifecycle

## State와 Lifecycle의 정의

### State

일반적으로 영어 단어 state는 상태라는 뜻을 가지고 있다.

그렇다면 리액트에서 state는 어떤 것의 상태를 의미할까?

리액트에서의 state는 **리액트 컴포넌트의 상태**를 의미한다. 다만 상태라는 단어가 정상인지, 비정상인지를 나타내는  것이라기보다 **리액트 컴포넌트의 데이터**라는 의미에 더 가깝다. 쉽게 말하면 **리액트 컴포넌트의 변경 가능한 데이터**를 **state**라고 부른다. 

이 state는 사전에 미리 정해진 것이 아니라 **리액트 컴포넌트를 개발하는 각 개발자가 직접 정의해서 사용**한다. state를 정의할 때 중요한 점은 **꼭 렌더링이나 데이터 흐름에 사용되는 것만 state에 포함**시켜야 한다. 왜냐하면 **state가 변경될 경우 컴포넌트가 재렌더링**되기 때문에 렌더링과 데이터 흐름에 관련 없는 값을 포함하면 불필요한 경우에 컴포넌트가 다시 렌더링이 되어 성능을 저하시킬 수 있기 때문이다. 그래서 **렌더링과 데이터 흐름에 관련 있는 값만 state에 포함**하도록 해야 하며 **그렇지 않은 값**은 **컴포넌트의 인스턴스 필드로 정의**하면 된다.

**리액트의 state**는 따로 복잡한 형태가 있는 것이 아니라 그냥 하나의 **자바스크립트 객체**이다.

**예제 코드**

```jsx
class LikeButton extends React.Component {
    constructor(props) {
        super(props) ;

        this.sate  = {
            liked: false;
        };
    }
    ...
}
```

위 코드는 `LikeButton` 이라는 리액트 클래스 컴포넌트를 나타낸 것이다.

**모든 클래스 컴포넌트**에는 `constructor` 라는 **이름의 함수가 존재**하는데, 우리말로 **생성자**라는 의미를 가지고 있으며 **클래스가 생성될 때 실행되는 함수**이다.

이 생성자 코드를 보면 `this.state`라는 부분이 나오는데, 이 부분이 바로 현재 컴포넌트의 `state`를 정의하는 부분이다. **클래스 컴포넌트**의 경우 **state를 생성자에서 정의**한다. **함수 컴포넌트**는 **state를 useState라는 hook을 사용해서 정의**하게 된다.

**이렇게 정의한 state는 정의된 이후 일반적인 자바스크립트 변수를 다루듯이 직접 수정할 수는 없다**. 엄밀히 말하면 수정이 가능하긴 하지만 그렇게 해서는 안된다.

**예제 코드**

```jsx
// state를 직접 수정(잘못된 사용법)
this.state = {
    name: 'Heo'
};

// setState 함수를 통한 수정(정상적인 사용법)
this.setState({
    name: 'Heo'
});
```

state를 직접 수정할 수는 있지만 그렇게 하면 안되기 때문에 애초에 state는 직접적인 변경이 불가능하다고 생각하는 것이 좋다. 또한 앞에서 언급한 것처럼 리액트에서의 state는 컴포넌트의 렌더링과 관련이 있기 때문에 마음대로 수정하게 되면 개발자가 의도한 대로 작동하지 않을 가능성이 있다.

그래서 **클래스 컴포넌트에서 state를 변경하고자 할 때에는 꼭 setState라는 함수를 사용하자!**

### Lifecycle

**React Component의 생명 주기**

영어 단어 **Lifecycle**은 **생명 주기**라는 뜻을 가지고 있다. 사람의 생명 주기를 생각하면 출생을 하고 쭉 인생을 살다가 노화가 오게 되어 사망하게 된다. 마찬가지로 리액트 컴포넌트도 이러한 생명 주기를 가지고 있다. **컴포넌트가 생성되는 시점과 사라지는 시점이 정해져 있다는 의미**이다.

아래 그림은 **리액트 클래스 컴포넌트의 생명주기**를 나타낸 것이다.

![스크린샷 2023-11-29 오후 3.05.49.png](https://github.com/Heo-y-y/development-blog/assets/112863029/4704cc43-2505-4031-9f95-999ea54b8c7c)

위 그림을 보면 크게 출생, 인생, 사망으로 나누어져 있다. **각 과정의 제일 하단에 표시된 부분**은 **생명 주기에 따라 호출되는 클래스 컴포넌트의 함수**이다. 이 함수들을 **Lifecycle 메서드**라고 부르며 번역하면 **생명 주기 함수**이다.

1. **생성되는 시점**(출생)
    
    이 과정을 Mount라고 부르는데 **이때 컴포넌트의 생성자가 실행**된다. 앞에서 본 것처럼 **생성자에서는 컴포넌트의 state를 정의**하게 된다. 또한 **컴포넌트가 렌더링되며 이후에** `componentDidMount` **함수가 호출**된다.
    
2. **업데이트되는 시점**(인생)
    
    업데이트 과정에서는 **컴포넌트의 props가 변경**되거나 `setState` **함수 호출에 의해 state가 변경**되거나 `falseUpdate`**라는 강제 업데이트 함수 호출로 인해 컴포넌트가 다시 렌더링**된다. 그리고 **렌더링 이후**에 `componentDidUpdate` **함수가 호출**된다.
    
3. **언마운트되는 시점**(사망)
    
    **상위 컴포넌트에서 현재 컴포넌트를 더 이상 화면에 표시하지 않게 될 때 Unmount 된다**고 볼 수 있다. 이때 **언마운트 직전**에 `componentWillUnmount` **함수가 호출**된다.
    

**참고 자료**

- [https://www.inflearn.com/course/lecture?courseSlug=처음-만난-리액트&unitId=113274&tab=curriculum](https://www.inflearn.com/course/lecture?courseSlug=%EC%B2%98%EC%9D%8C-%EB%A7%8C%EB%82%9C-%EB%A6%AC%EC%95%A1%ED%8A%B8&unitId=113274&tab=curriculum)
