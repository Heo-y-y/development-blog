## ê°ì²´ ì§€í–¥ ì›ë¦¬ ì ìš©

### ìƒˆë¡œìš´ í• ì¸ ì •ì±… ê°œë°œ

ë§Œì•½ì— ê¸°íšìê°€ í• ì¸ ì •ì±…ì„ ê³ ì • í• ì¸ ê¸ˆì•¡ì—ì„œ ì£¼ë¬¸ ê¸ˆì•¡ë‹¹ í• ì¸í•˜ëŠ” ì •ë¥  % í• ì¸ìœ¼ë¡œ ë°”ê¾¸ìê³  í•©ë‹ˆë‹¤. ì›ë˜ ê°™ìœ¼ë©´ ì½”ë“œë¥¼ ìƒˆë¡œ ë‹¤ ë§Œë“¤ì–´ ê³ ìƒì„ í–ˆê² ì§€ë§Œ í˜„ì¬ ìš°ë¦° ë‹¤í˜•ì„±ì„ í™œìš©í•´ ê°œë°œ í–ˆê¸° ë•Œë¬¸ì—, êµ¬í˜„ì²´ë§Œ ë§Œë“¤ì–´ì„œ ì¸í„°í˜ì´ìŠ¤ì— ì ìš©ë§Œ ì‹œì¼œì£¼ë©´ ë©ë‹ˆë‹¤!

ì¦‰, `DiscountPolicy` **ì¸í„°í˜ì´ìŠ¤**ë§Œ **ìƒì†**ë°›ì•„ `@Override` ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ **ì¬ì •ì˜ í•´ ì‚¬ìš©**í•˜ë©´ ë©ë‹ˆë‹¤.

```java
public class RateDiscountPolicy implements DiscountPolicy{
    private int discountPercent = 10;
    @Override
    public int discount(Member member, int price) {
        if (member.getGrade() == Grade.VIP) {
            return price * discountPercent / 100;
        } else {
            return 0;
        }
    }
}
```

ì´ì œ `RateDiscountPolicy` í´ë˜ìŠ¤ì˜ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•´ë³´ê² ìŠµë‹ˆë‹¤.

```java
class RateDiscountPolicyTest {

    RateDiscountPolicy discountPolicy = new RateDiscountPolicy();

    @Test
    @DisplayName("VIPëŠ” 10% í• ì¸ì´ ì ìš©ë˜ì–´ì•¼ í•œë‹¤.")
    void vipOk() {
        // given
        Member member = new Member(1L, "memberVIP", Grade.VIP);
        // when
        int discount = discountPolicy.discount(member, 10000);
        // then
        assertThat(discount).isEqualTo(1000);
    }

    @Test
    @DisplayName("VIPê°€ ì•„ë‹ˆë©´ í• ì¸ì´ ì ìš©ë˜ì§€ ì•Šì•„ì•¼ í•œë‹¤.")
    void vipX() {
        // given
        Member member = new Member(2L, "memberBASIC", Grade.BASIC);
        // when
        int discount = discountPolicy.discount(member, 10000);
        // then
        assertThat(discount).isEqualTo(0);
    }
}
```

`@DisplayName`ì„ í™œìš©í•˜ë©´ í•œê¸€ë¡œë„ ì‘ì„± ê°€ëŠ¥í•©ë‹ˆë‹¤.

ì‚¬ìš©ìê°€ **VIP**ì¸ ìƒí™©ê³¼ **BASIC**ì¸ ìƒí™©ì„ í…ŒìŠ¤íŠ¸í–ˆìŠµë‹ˆë‹¤. ì´ì²˜ëŸ¼ ì‰½ê²Œ í•  ìˆ˜ ìˆëŠ”ê±´ í˜„ì¬ ê°ì²´ì§€í–¥ ì„¤ê³„ë¥¼ ì˜ ì§€ì¼œ ì‘ì„±í–ˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

### ìƒˆë¡œìš´ í• ì¸ ì •ì±… ì ìš©ê³¼ ë¬¸ì œì 

í˜„ì¬ í• ì¸ ì •ì±…ì„ ë³€ê²½í•˜ë ¤ë©´ í• ì¸ ì •ì±…ì˜ í´ë¼ì´ì–¸íŠ¸ì¸ `OrderServiceImpl` í´ë˜ìŠ¤ì˜ ì½”ë“œë¥¼ ê³ ì³ì•¼ í•©ë‹ˆë‹¤.

```java
public class OrderServiceImpl implements OrderService {
    private final MemberReposiotry memberReposiotry = new MemoryMemberRepository();
//    private final DiscountPolicy discountPolicy = new FixDiscountPolicy();
    private final DiscountPolicy discountPolicy = new RateDiscountPolicy();
    
```

í˜„ì¬ ìƒí™©ì˜ **ë¬¸ì œì **ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.

ì§€ê¸ˆ OCPì™€ DIP ê°™ì€ ê°ì²´ì§€í–¥ ì„¤ê³„ ì›ì¹™ì„ ì¤€ìˆ˜í•œ ê²ƒì²˜ëŸ¼ ë³´ì´ì§€ë§Œ, ì‚¬ì‹¤ì€ ì•„ë‹™ë‹ˆë‹¤.

**DIP**ë¶€í„° ë¨¼ì € ì‚´í´ë³´ë©´, ìœ„ì— í´ë˜ìŠ¤ ì˜ì¡´ê´€ê³„ë¥¼ ë³´ë©´, `DiscountPolicy` **ì¶”ìƒ**(**ì¸í„°í˜ì´ìŠ¤**) ë¿ë§Œ ì•„ë‹ˆë¼ `RateDiscountPolicy, FixDiscountPolicy` **êµ¬í˜„**(**êµ¬í˜„**)í´ë˜ìŠ¤ì—ë„ **ì˜ì¡´**í•˜ê³  ìˆìŠµë‹ˆë‹¤.

ë‹¤ìŒì€ **OCP**ë¥¼ ë³´ê² ìŠµë‹ˆë‹¤. 

í˜„ì¬ ì½”ë“œëŠ” ê¸°ëŠ¥ì„ í™•ì¥í•´ì„œ ë³€ê²½í•˜ë©´, **í´ë¼ì´ì–¸íŠ¸ ì½”ë“œ**(`OrderServiceImpl`)ì— ì˜í–¥ì„ ì¤ë‹ˆë‹¤.

ê¸°ëŒ€í–ˆë˜ ê·¸ë¦¼ì€ ì•„ë˜ ê·¸ë¦¼ì´ì§€ë§Œ,

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-31 á„‹á…©á„’á…® 9 15 47](https://github.com/Heo-y-y/development-blog/assets/112863029/78f02a0a-cf7e-4ebb-91d1-e3e18005d812)

í˜„ì¬ ìƒí™©ì„ ê·¸ë¦¼ìœ¼ë¡œ ë‚˜íƒ€ë‚´ë©´ ì´ëŸ¬í•œ ìƒí™©ì¸ ê²ƒ ì…ë‹ˆë‹¤.

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-31 á„‹á…©á„’á…® 9 16 35](https://github.com/Heo-y-y/development-blog/assets/112863029/029c7f32-2c57-44b2-8b0d-58c09d3e1d86)

ì¦‰, **ì¶”ìƒì—ë„ ì˜ì¡´**í•˜ê³ , **êµ¬ì²´ì ì¸ ê²ƒì—ë„ ì˜ì¡´**í•˜ê³  ìˆëŠ” ê²ƒ ì…ë‹ˆë‹¤.(**DIP ìœ„ë°˜**)

ë˜í•œ **í™•ì¥í•˜ì—¬ ë³€ê²½í•˜ëŠ” ìˆœê°„ í´ë¼ì´ì–¸íŠ¸ ì½”ë“œë„ ê°™ì´ ë³€ê²½**í•´ì•¼ í•©ë‹ˆë‹¤.(**OCP ìœ„ë°˜**)

**ë¬¸ì œ í•´ê²°**

ì¼ë‹¨ **DIP ìœ„ë°˜** ë¶€í„° ë³€ê²½í•´ë³´ê² ìŠµë‹ˆë‹¤. **ì¶”ìƒ**(**ì¸í„°í˜ì´ìŠ¤**)ì—ë§Œ **ì˜ì¡´í•˜ë„ë¡ ë³€ê²½**í•˜ë©´ ì½”ë“œëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.

```java
public class OrderServiceImpl implements OrderService {
    private final MemberReposiotry memberReposiotry = new MemoryMemberRepository();
    private DiscountPolicy discountPolicy;
```

ê·¼ë° ì´ ìƒíƒœë¡œ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ëŒë¦¬ë©´ ì•„ë˜ì™€ ê°™ì´ ì—ëŸ¬ê°€ ë‚©ë‹ˆë‹¤.

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-31 á„‹á…©á„’á…® 9 21 08](https://github.com/Heo-y-y/development-blog/assets/112863029/c2191015-9294-4e41-b098-bf1338559e65)

ì´ìœ ëŠ” í˜„ì¬ ë‹¹ì—°íˆ êµ¬í˜„ ê°ì²´ê°€ ì—†ìœ¼ë‹ˆ ê°’ì„ ì£¼ì…í•  ìˆ˜ ì—†ì–´ì„œ **NPE**ê°€ ë°œìƒí•˜ëŠ” ê²ƒ ì…ë‹ˆë‹¤.

ê·¸ëŸ¬ë©´ `OrderServiceImpl`ì— `DiscountPolicy`ì˜ êµ¬í˜„ ê°ì²´ë¥¼ ëŒ€ì‹  ìƒì„±í•˜ê³  ì£¼ì…í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.

## ê´€ì‹¬ì‚¬ì˜ ë¶„ë¦¬

í˜„ì¬ëŠ” ê°**ê°ì˜ ì¸í„°í˜ì´ìŠ¤**ê°€ **ë„ˆë¬´ ë§ì€ ì±…ì„**ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. ê° ì¸í„°í˜ì´ìŠ¤ëŠ” **ìì‹ ì´ ë§¡ì€ ì—­í• ë§Œ ìˆ˜í–‰**í•˜ëŠ” ê²ƒì— ì§‘ì¤‘í•´ì•¼ í•©ë‹ˆë‹¤. ì¦‰, ì—­í• ì— ë§ëŠ” **êµ¬í˜„ì²´ë¥¼ ì§€ì •í•˜ëŠ” ì±…ì„ì„ ë‹´ë‹¹í•˜ëŠ” í´ë˜ìŠ¤**ë¥¼ í•˜ë‚˜ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤.

### AppConfig êµ¬í˜„

ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì „ì²´ ë™ì‘ ë°©ì‹ì„ ì„¤ì •í•˜ê¸° ìœ„í•´, **êµ¬í˜„ ê°ì²´ë¥¼ ìƒì„±**í•˜ê³ , **ì—°ê²°í•˜ëŠ” ì±…ì„**ì„ ë‹´ë‹¹í•˜ëŠ” ë³„ë„ì˜ ì„¤ì • í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì–´ë³´ê² ìŠµë‹ˆë‹¤.

```java
public class AppConfig {

    public MemberService memberService() {
        return new MemberServiceImpl(new MemoryMemberRepository());
    }

    public OrderService orderService() {
        return new OrderServiceImpl(new MemoryMemberRepository(), new FixDiscountPolicy());
    }
}
```

ìœ„ ì½”ë“œë¥¼ ë³´ë©´, AppConfig í´ë˜ìŠ¤ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë™ì‘ì— í•„ìš”í•œ **êµ¬í˜„ ê°ì²´ë¥¼ ìƒì„±**í•©ë‹ˆë‹¤. ê·¸ë¦¬ê³  ìƒì„±í•œ ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ì˜ ì°¸ì¡°(ë ˆí¼ëŸ°ìŠ¤)ë¥¼ **ìƒì„±ìë¥¼ í†µí•´ì„œ ì£¼ì…**(ì—°**ê²°**)ì‹œì¼œì¤ë‹ˆë‹¤.

- **MemberServiceImpl â†’ MemoryMemberRepository**
- **OrderServiceImpl â†’MemoryMemberRepository, FixDiscountPolicy**

ê·¸ë¦¬ê³  ê° `MemberServiceImpl`ê³¼ `OrderServiceImpl`ì— **ìƒì„±ì ì£¼ì…**ì„ í•´ì¤ë‹ˆë‹¤.

```java
public class MemberServiceImpl implements MemberService{

    private final MemberReposiotry memberReposiotry;

    public MemberServiceImpl(MemberReposiotry memberReposiotry) {
        this.memberReposiotry = memberReposiotry;
    }

    @Override
    public void join(Member member) {
        memberReposiotry.save(member);
    }

    @Override
    public Member findMember(Long memberId) {
        return memberReposiotry.findById(memberId);
    }
}
```

```java
public class OrderServiceImpl implements OrderService {
    private final MemberReposiotry memberReposiotry;
    private final DiscountPolicy discountPolicy;

    public OrderServiceImpl(MemberReposiotry memberReposiotry, DiscountPolicy discountPolicy) {
        this.memberReposiotry = memberReposiotry;
        this.discountPolicy = discountPolicy;
    }

    @Override
    public Order createOrder(Long memberId, String itemName, int itemPrice) {
        Member member = memberReposiotry.findById(memberId);
        int discountPrice = discountPolicy.discount(member, itemPrice);
        return new Order(memberId, itemName, itemPrice, discountPrice);
    }
}
```

ì„¤ê³„ ë³€ê²½ìœ¼ë¡œ ê° `OrderServiceImpl`ê³¼ `MemberServiceImpl`ì€ **êµ¬í˜„ì²´ë“¤ì—ê²Œ ì˜ì¡´í•˜ì§€ ì•Šê²Œ ëìŠµë‹ˆë‹¤**.

ë‹¨ì§€ ê° **ì¸í„°í˜ì´ìŠ¤ì—ë§Œ** **ì˜ì¡´**í•©ë‹ˆë‹¤.

ì¦‰, ìƒì„±ìë¥¼ í†µí•´ ì–´ë–¤ êµ¬í˜„ ê°ì²´ê°€ ë“¤ì–´ì˜¬ì§€ ì•Œ ìˆ˜ ì—†ê²Œ ëœ ê²ƒ ì…ë‹ˆë‹¤. ê° ìƒì„±ìë¥¼ í†µí•´ì„œ ì–´ë–¤ êµ¬í˜„ ê°ì²´ë¥¼ ì£¼ì…í• ì§€ëŠ” ì˜¤ì§ ì™¸ë¶€ `AppConfig` í´ë˜ìŠ¤ì—ì„œ ë‹´ë‹¹í•©ë‹ˆë‹¤. 

ì •ë¦¬í•˜ë©´, `OrderServiceImpl` ê³¼ `MemberServiceImpl` ì— **ê°ì²´ì˜ ì˜ì¡´ê´€ê³„ê°€ ì£¼ì…**ì´ ë©ë‹ˆë‹¤. ì´ê²ƒì„ **DI**(**ì˜ì¡´ì„±** **ì£¼ì…**)ì´ë¼ê³  í•©ë‹ˆë‹¤.

ê°„ë‹¨í•˜ê²Œ ****`OrderServiceTest`**í…ŒìŠ¤íŠ¸ ì½”ë“œë¡œ ë³€ê²½ëœ ì½”ë“œì™€ ìƒˆë¡œ ì‘ì„±í•œ ì–´ë…¸í…Œì´ì…˜**ì„ ì‚´í´ë³´ë©´,

```java
class OrderServiceTest {
     MemberService memberService;
     OrderService orderService;
     @BeforeEach
     public void beforeEach() {
         AppConfig appConfig = new AppConfig();
         memberService = appConfig.memberService();
         orderService = appConfig.orderService();
			} 
}
```

ì¼ë‹¨ `MemberService`ì™€ `OrderService`ë¥¼ ë§Œë“­ë‹ˆë‹¤.

ê·¸ë¦¬ê³  `@BeforeEach` ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•´ `AppConfig`ë¥¼ ìƒì„±í•´ì£¼ê³ , `memberService`ì™€ `orderService`ì— ì£¼ì…í•´ì¤ë‹ˆë‹¤. 

`@BeforeEach` ë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ ëŠ” ì‹¤í–‰í•˜ê¸° ì „ì— ë¨¼ì € í•´ë‹¹ ë©”ì„œë“œê°€ ì‘ë™í•˜ë©´ì„œ, `memberService` ì™€ 

`orderService` ì— `AppConfig`ì—ì„œ **ì •í•œ êµ¬í˜„ì²´ë¥¼ ì£¼ì…**ì‹œì¼œì£¼ê¸° ìœ„í•¨ì…ë‹ˆë‹¤.

### AppConfig ë¦¬íŒ©í„°ë§

í˜„ì¬ `AppConfig` í´ë˜ìŠ¤ë¥¼ ë³´ë©´ ì¤‘ë³µì´ ìˆê³ , ì—­í• ì— ë”°ë¥¸ êµ¬í˜„ì´ ì˜ ë³´ì´ì§€ ì•ŠìŠµë‹ˆë‹¤.

ì½”ë“œë¥¼ ìˆ˜ì •í•´ë³´ë©´ ì•„ë˜ì™€ ê°™ì´ ë³€ê²½ë©ë‹ˆë‹¤.

```java

public class AppConfig {

    public MemberService memberService() {
        return new MemberServiceImpl(memberRepository());
    }

    private static MemberReposiotry memberRepository() {
        return new MemoryMemberRepository();
    }

    public OrderService orderService() {
        return new OrderServiceImpl(memberRepository(), discountPolicy());
    }

    public DiscountPolicy discountPolicy() {
        return new FixDiscountPolicy();
    }
}
```

`new MemoryMemberRepository()`ê°€ ì¤‘ë³µë˜ëŠ” ë¶€ë¶„ì„ ì œê±°í•¨ìœ¼ë¡œì¨ `MemoryMemberRepository`ë¥¼ ë‹¤ë¥¸ êµ¬í˜„ì²´ë¡œ ë³€ê²½í•  ë•Œ í•œ ë¶€ë¶„ë§Œ ë³€ê²½í•˜ë©´ ë©ë‹ˆë‹¤.

ì¦‰, í•œë²ˆì— `OrderService`ì™€ `MemberService`ì— ì ìš©ë˜ëŠ” `MemoryMemberRepository`ë¥¼ ë³€ê²½í•  ìˆ˜ ìˆëŠ” ê²ƒ ì…ë‹ˆë‹¤.

### ìƒˆë¡œìš´ êµ¬ì¡°ì™€ í• ì¸ ì •ì±… ì ìš©

`AppConfig`ì˜ í™œìš©ë„ë¥¼ ì•Œì•„ë³´ê¸° ìœ„í•´ í•œë²ˆ `FixDiscountPolicy`ì—ì„œ `RateDiscountPolicy`ë¡œ ë³€ê²½í•´ë³´ê² ìŠµë‹ˆë‹¤.

```java
public class AppConfig {

    public OrderService orderService() {
        return new OrderServiceImpl(memberRepository(), discountPolicy());
    }

    public DiscountPolicy discountPolicy() {
	//			return new FixDiscountPolicy();
        return new RateDiscountPolicy();
    }
}
```

ìœ„ ì½”ë“œë¥¼ ë³´ë©´, `AopConfig`ê°€ ì´ì œ êµ¬í˜„ì²´ë¥¼ ì§€ì •í•´ì£¼ëŠ” ì—­í• ì„ í•œë‹¤ê³  í–ˆìŠµë‹ˆë‹¤. ì¦‰, `RateDiscountPolicy()`ë§Œ ë„£ì–´ì£¼ë©´ ë˜ëŠ” ê²ƒ ì…ë‹ˆë‹¤.

`AppConfig`ì„ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ í¬ê²Œ **ì‚¬ìš© ì˜ì—­**ê³¼ **ê°ì²´ë¥¼ ìƒì„±í•˜ê³  êµ¬ì„±í•˜ëŠ” ì˜ì—­**ìœ¼ë¡œ **ë¶„ë¦¬**ê°€ ëìŠµë‹ˆë‹¤.

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-31 á„‹á…©á„’á…® 10 40 10](https://github.com/Heo-y-y/development-blog/assets/112863029/88235096-ec9f-4ffc-ae5d-7285c47f8515)

ì´ë ‡ê²Œ ë¶„ë¦¬í•´ì¤˜ì„œ ì´ì œ í• ì¸ ì •ì±…ì„ ë³€ê²½í•´ë„ **êµ¬ì„± ì˜ì—­ë§Œ ì˜í–¥**ì„ ë°›ê³ , **ì‚¬ìš© ì˜ì—­ì€ ì „í˜€ ì˜í–¥ì„ ë°›ì§€ ì•ŠìŠµë‹ˆë‹¤**.

## IoC, DI, ì»¨í…Œì´ë„ˆ

### IoC(ì œì–´ì˜ ì—­ì „ - Inversion of Control)

í˜„ì¬ `AppConfig`ë¥¼ ë§Œë“  í›„ì—ëŠ” **êµ¬í˜„ ê°ì²´ë¥¼ ì§€ì •**í•´ì£¼ëŠ” ì—­í• ì„ `AppConfig`ì—ì„œ **ë‹´ë‹¹**í•©ë‹ˆë‹¤. ì¦‰, êµ¬í˜„ ê°ì²´ëŠ” ìì‹ ì˜ ë¡œì§ì„ ì‹¤í–‰í•˜ëŠ” ì—­í• ì—ë§Œ ì§‘ì¤‘í•©ë‹ˆë‹¤. ì´ ì–˜ê¸°ëŠ” **í”„ë¡œê·¸ë¨ì˜ ì œì–´ íë¦„**ì„ `AppConfig`ê°€ ê°€ì ¸ê°„ë‹¤ëŠ” ê²ƒ ì…ë‹ˆë‹¤.

ì´ë ‡ê²Œ **í”„ë¡œê·¸ë¨ì˜ ì œì–´ íë¦„ì„ ì§ì ‘ ì œì–´í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ì™¸ë¶€ì—ì„œ ê´€ë¦¬í•˜ëŠ” ê²ƒ**ì„ **IoC**(**ì œì–´ì˜ ì—­ì „**)ì´ë¼ê³  í•©ë‹ˆë‹¤.

- **í”„ë ˆì„ì›Œí¬ / ë¼ì´ë¸ŒëŸ¬ë¦¬**
    - **í”„ë ˆì„ì›Œí¬ê°€ ë‚´ê°€ ì‘ì„±í•œ ì½”ë“œë¥¼ ì œì–´**í•˜ê³ , ëŒ€ì‹  ì‹¤í–‰í•˜ë©´ ê·¸ê²ƒì€ **í”„ë ˆì„ì›Œí¬**ì…ë‹ˆë‹¤.
    - **ë‚´ê°€ ì‘ì„±í•œ ì½”ë“œê°€ ì§ì ‘ ì—ì–´ì˜ íë¦„ì„ ë‹´ë‹¹**í•œë‹¤ë©´ ê·¸ê²ƒì€ í”„ë ˆì„ì›Œí¬ê°€ ì•„ë‹ˆë¼ **ë¼ì´ë¸ŒëŸ¬ë¦¬**ì…ë‹ˆë‹¤.

### DI(ì˜ì¡´ê´€ê³„ ì£¼ì… - Dependency Injection)

í˜„ì¬ `OrderServiceImpl`ì€ `DiscountPolicy` ì¸í„°í˜ì´ìŠ¤ì— ì˜ì¡´í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ ì‹¤ì œë¡œ ì–´ë–¤ êµ¬í˜„ ê°ì²´ê°€ ì‚¬ìš©ë ì§€ëŠ” ëª¨ë¦…ë‹ˆë‹¤.

ì˜ì¡´ê´€ê³„ëŠ” **ì •ì ì¸ í´ë˜ìŠ¤ ì˜ì¡´ê´€ê³„ì™€ ì‹¤í–‰ ì‹œì ì— ê²°ì •ë˜ëŠ” ë™ì ì¸ ê°ì²´(ì¸ìŠ¤í„´ìŠ¤) ì˜ì¡´ê´€ê³„** ë‘˜ì„ ë¶„ë¦¬í•´ì„œ ìƒê°í•´ì•¼í•©ë‹ˆë‹¤.

- **ì •ì ì¸ í´ë˜ìŠ¤ ì˜ì¡´ê´€ê³„**
    
    í´ë˜ìŠ¤ê°€ ì‚¬ìš©í•˜ëŠ” `import` ì½”ë“œë§Œ ë³´ê³  **ì˜ì¡´ê´€ê³„ë¥¼ íŒŒì•…**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¦‰, ì• **í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•˜ì§€ ì•Šì•„ë„ ë¶„ì„ì´ ê°€ëŠ¥**í•©ë‹ˆë‹¤.
    
    ì•„ë˜ ì½”ë“œë¥¼ ë³´ë©´,
    
    ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 2 44 44](https://github.com/Heo-y-y/development-blog/assets/112863029/245ac452-a55f-4bc2-b120-741f668c0fa6)
    
    `OrderServiceImpl`ì€ `MemberRepository`ì™€ `DiscountPolicy`, `Member`ì— ì˜ì¡´í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ í•´ë‹¹ í´ë˜ìŠ¤ ë§Œìœ¼ë¡œëŠ” ì‹¤ì œ ì–´ë–¤ ê°ì²´ê°€ `OrderServiceImpl`ì— ì£¼ì…ì´ ë˜ëŠ”ì§€ëŠ” ì•Œ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
    
- **ë™ì ì¸ ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ ì˜ì¡´ê´€ê³„**
    
    ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ ì‹œì ì— ì‹¤ì œ ìƒì„±ëœ ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ì˜ ì°¸ì¡°ê°€ ì—°ê²°ëœ ì˜ì¡´ê´€ê³„ì…ë‹ˆë‹¤.
    
    **ê°ì²´ ë‹¤ì´ì–´ê·¸ë¨**
    
    ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 2 49 17](https://github.com/Heo-y-y/development-blog/assets/112863029/82f9f9b0-6782-455e-9dc2-f54d50b33c11)
  
    - ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ ì‹œì (ëŸ°íƒ€ì„)ì— ì™¸ë¶€ì—ì„œ ì‹¤ì œ êµ¬í˜„ ê°ì²´ë¥¼ ìƒì„±í•˜ê³  í´ë¼ì´ì–¸íŠ¸ì— ì „ë‹¬í•´ì„œ í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ì˜ ì‹¤ì œ ì˜ì¡´ê´€ê³„ê°€ ì—°ê²°ë˜ëŠ” ê²ƒì„ **ì˜ì¡´ê´€ê³„ ì£¼ì…**ì´ë¼ê³  í•©ë‹ˆë‹¤.
    - ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ê³ , ê·¸ ì°¸ì¡° ê°’ì„ ì „ë‹¬í•´ì„œ ì—°ê²°ë©ë‹ˆë‹¤.
    - ì˜ì¡´ê´€ê³„ ì£¼ì…ì„ ì‚¬ìš©í•˜ë©´ í´ë¼ì´ì–¸íŠ¸ ì½”ë“œë¥¼ ë³€ê²½í•˜ì§€ ì•Šê³ , í´ë¼ì´ì–¸íŠ¸ê°€ í˜¸ì¶œí•˜ëŠ” ëŒ€ìƒì˜ íƒ€ì… ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    - ì˜ì¡´ê´€ê³„ ì£¼ì…ì„ ì‚¬ìš©í•˜ë©´ ì •ì ì¸ í´ë˜ìŠ¤ ì˜ì¡´ê´€ê³„ë¥¼ ë³€ê²½í•˜ì§€ ì•Šê³ , ë™ì ì¸ ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ ì˜ì¡´ê´€ê³„ë¥¼ ì‰½ê²Œ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### IoC ì»¨í…Œì´ë„ˆ, DI ì»¨í…Œì´ë„ˆ

`AppConfig`ì²˜ëŸ¼ ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ê´€ë¦¬í•˜ë©´ì„œ ì˜ì¡´ê´€ê³„ë¥¼ ì—°ê²°í•´ ì£¼ëŠ” ê²ƒì„ **IoC ì»¨í…Œì´ë„ˆ** ë˜ëŠ” **DI ì»¨í…Œì´ë„ˆ**ë¼ê³  í•©ë‹ˆë‹¤. 

í•˜ì§€ë§Œ ì˜ì¡´ê´€ê³„ ì£¼ì…ì— ì¢€ë” ì´ˆì ì„ ë‘ì–´ ë¶€ë¥´ë©´ DI ì»¨í…Œì´ë„ˆë¼ê³  í•œë‹¤. ë˜ëŠ” ì–´ìƒ˜ë¸”ëŸ¬, ì˜¤ë¸Œì íŠ¸ íŒ©í† ë¦¬ ë“±ìœ¼ë¡œ ë¶ˆë¦¬ê¸°ë„ í™ë‹ˆë‹¤.

## ìŠ¤í”„ë§ìœ¼ë¡œ ì „í™˜

ê·¸ëŸ¬ë©´ ì´ì œ ìˆœìˆ˜ ìë°” ì½”ë“œë¥¼ ìŠ¤í”„ë§ìœ¼ë¡œ ì „í™˜ì‹œì¼œ ë³´ê² ìŠµë‹ˆë‹¤.

ë¨¼ì € `AppConfig` ì½”ë“œë¥¼ ìˆ˜ì •í–ˆìŠµë‹ˆë‹¤.

```java
@Configuration // (1)
public class AppConfig {

    @Bean // (2)
    public MemberService memberService() {
        return new MemberServiceImpl(memberRepository());
    }

    @Bean
    public MemberReposiotry memberRepository() {
        return new MemoryMemberRepository();
    }

    @Bean
    public OrderService orderService() {
        return new OrderServiceImpl(memberRepository(), discountPolicy());
    }

    @Bean
    public DiscountPolicy discountPolicy() {
//        return new FixDiscountPolicy();
        return new RateDiscountPolicy();
    }
}
```

ë¨¼ì € (1) `AppConfig` í´ë˜ìŠ¤ì— `@Configuration`ì„ ì¶”ê°€í•´ ì¤ë‹ˆë‹¤. í•´ë‹¹ ì–´ë…¸í…Œì´ì…˜ì€ **ìŠ¤í”„ë§ì—ê²Œ ì„¤ì • ì •ë³´ë¼ê³  ì•Œë ¤ì£¼ëŠ” ê²ƒ** ì…ë‹ˆë‹¤.

(2) `@Bean`ì€ ìƒì„±ëœ ê°ì²´ë¥¼ **ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì˜ ë¹ˆìœ¼ë¡œ ë“±ë¡**í•´ ì¤ë‹ˆë‹¤.

ê·¸ëŸ¬ë©´ ì´ì œ `MemberApp`ì— **ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ ì ìš©**ì‹œì¼œë³´ê² ìŠµë‹ˆë‹¤.

```java
public class MemberApp {
    public static void main(String[] args) {
//        AppConfig appConfig = new AppConfig();
//        MemberService memberService = appConfig.memberService();

        ApplicationContext applicationContext = new AnnotationConfigApplicationContext(AppConfig.class);
        MemberService memberService = applicationContext.getBean("memberService", MemberService.class);

        Member member = new Member(1L, "memberA", Grade.VIP);
        memberService.join(member);

        Member findMember = memberService.findMember(1L);
        System.out.println("newMember = " + member.getName());
        System.out.println("findMember = " + findMember.getName());
        
    }
}
```

`ApplicationContext`ëŠ” **ë¹ˆì„ ê´€ë¦¬**í•´ ì¤ë‹ˆë‹¤. ì¦‰, `AppConfig`ì— ìˆëŠ” **ì„¤ì • ì •ë³´ë¥¼ ê°€ì§€ê³  ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì—ë‹¤ê°€ ê°ì²´ ìƒì„±í•œ ê²ƒì„ ê´€ë¦¬**í•˜ëŠ” ê²ƒ ì…ë‹ˆë‹¤.

`getBean()` ë©”ì„œë“œë¡œ í•´ë‹¹ ì´ë¦„ê³¼ ë™ì¼í•œ ê²ƒì„ ì°¾ì•„ì„œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì‹¤í–‰ì„ ì‹œì¼œ ë³´ë©´,

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 3 12 46](https://github.com/Heo-y-y/development-blog/assets/112863029/99aed1bc-6322-45f6-9bc7-2f0209725ccf)

ìœ„ì— ê·¸ë¦¼ì„ ë³´ë©´ ğŸŸ¥Â ì€ ìŠ¤í”„ë§ì—ì„œ í•„ìš”í•œ ê²ƒì„ ìë™ìœ¼ë¡œ ì°¾ì•„ ë“±ë¡í•´ì£¼ëŠ” ê²ƒ ì…ë‹ˆë‹¤. 

ì œê°€ ë´ì•¼í•  ê²ƒì€ ğŸŸ¨Â ì¸ë°, ë³´ë©´ ìš°ë¦¬ê°€ `@Configuration` ì™€ `@Bean` ë¥¼ ì‚¬ìš©í•´ ë“±ë¡í–ˆë˜ ê²ƒë“¤ì´ ìƒì„±ëœ ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ

- `ApplicationContext`ë¥¼ **ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ**ë¼ê³  í•©ë‹ˆë‹¤.
- ê¸°ì¡´ì˜ ì½”ë“œëŠ” `AppConfig`ë¥¼ ì‚¬ìš©í•´ì„œ ì§ì ‘ ê°ì²´ë¥¼ ìƒì„±í•˜ê³  DIë¥¼ í–ˆì§€ë§Œ, ì´ì œëŠ” ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ í†µí•´ ì‚¬ìš©í•©ë‹ˆë‹¤.
- **ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ**ëŠ” `@Configuration`ì´ ë¶™ì€ `AppConfig`ë¥¼ ì„¤ì • ì •ë³´ë¡œ ì‚¬ìš©í•œë‹¤. ì—¬ê¸°ì„œ `@Bean`ì´ ë¶™ì–´ìˆëŠ” **ë©”ì„œë“œë¥¼ ëª¨ë‘ í˜¸ì¶œí•´ì„œ ë°˜í™˜ëœ ê°ì²´ë¥¼ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ë“±ë¡**í•˜ëŠ” ê²ƒ ì…ë‹ˆë‹¤. ì´ë ‡ê²Œ ë“±ë¡ëœ ê²ƒì„ **ìŠ¤í”„ë§ ë¹ˆ**ì´ë¼ê³  í•©ë‹ˆë‹¤.

**ì°¸ê³  ìë£Œ**
- <https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81-%ED%95%B5%EC%8B%AC-%EC%9B%90%EB%A6%AC-%EA%B8%B0%EB%B3%B8%ED%8E%B8?_gl=1*7xwan9*_ga*MTE1OTA0OTI0OC4xNjkzMjI2ODQ0*_ga_85V6SRKGJV*MTY5MzIyNjg0My4xLjEuMTY5MzIyODk3NC4zNC4wLjA](https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81-%ED%95%B5%EC%8B%AC-%EC%9B%90%EB%A6%AC-%EA%B8%B0%EB%B3%B8%ED%8E%B8?_gl=1*7xwan9*_ga*MTE1OTA0OTI0OC4xNjkzMjI2ODQ0*_ga_85V6SRKGJV*MTY5MzIyNjg0My4xLjEuMTY5MzIyODk3NC4zNC4wLjA).>
