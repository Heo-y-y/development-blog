# 쿠키와 보안 문제

쿠키를 사용해서 로그인 ID를 전달해 로그인을 유지할 수 있었지만, 여기에는 심각한 보안 문제가 있다.

### 보안 문제

- 쿠키 값은 임의로 변경할 수 있다.
    - 클라이언트가 쿠키를 강제로 변경하면 다른 사용자가 된다.
    - 실제 웹 브라우저 개발자 모드에서 변경할 수 있는 것을 확인 할 수 있다.
        
        ![스크린샷 2024-04-01 오후 11 10 05](https://github.com/Heo-y-y/development-blog/assets/112863029/b7b5852f-4921-4340-b0da-e32f2b26c9a2)
        
        위에 그림은 처음 로그인한 ID 2의 유저이다. 그러나 Application → Cookie에서 ID를 1로 변경하면 아래 그림처럼 ID 1인 유저로 로그인이 된다.
        
        ![스크린샷 2024-04-01 오후 11 11 10](https://github.com/Heo-y-y/development-blog/assets/112863029/7df5b09a-da49-451f-b5e8-f3a916f104e5)

- 쿠키에 보관된 정보는 훔쳐갈 수 있다.
    - 만약 쿠키에 개인정보나, 신용카드 정보 같이 중요한 정보가 있으면, 해당 정보는 웹 브라우저에도 보관되고, 네트워크 요청마다 계속 클라이언트에서 서버로 전달된다.
    - 쿠키의 정보가 나의 로컬 PC에서 털릴 수도 있고, 네트워크 전송 구간에서 털릴 수도 있다.
- 해커카 쿠키를 한번 훔쳐가면 평생 사용할 수 있다.
    - 해커카 쿠키를 훔쳐가서 그 쿠키로 악의적인 요청을 계속 시도할 수 있다.

### 대안

- 쿠키에 중요한 값을 노출하지 않고, 사용자 별로 예층 불가능한 임의의 토큰(랜덤 값)을 노출하고, 서버에서 토큰과 사용자 `id`를 매핑하여 인식한다. 그리고 서버에서 토큰을 관리한다.
- 토큰은 해커가 임의의 값을 넣어도 찾을 수 없도록 예상 불가능 해야 한다.
- 해커가 토큰을 털어가도 시간이 지나면 사용할 수 없도록 서버에서 해당 토큰의 만료시간을 짧게 유지한다. 또는 해킹이 의심되는 경우 서버에서 해당 토큰을 강제로 제거하면 된다.

---

**참고 자료**

- [https://www.inflearn.com/course/스프링-mvc-2](https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81-mvc-2)
