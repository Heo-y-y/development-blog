
ğŸ“ [GitHub](https://github.com/Heo-y-y/Spring_Roadmap/tree/main/%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC_%E1%84%8B%E1%85%B5%E1%86%B8%E1%84%86%E1%85%AE%E1%86%AB)

## í”„ë¡œì íŠ¸ í™˜ê²½ ì„¤ì •

### ë¼ì´ë¸ŒëŸ¬ë¦¬

**Gradle**ì€ **ì˜ì¡´ê´€ê³„ê°€ ìˆëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í•¨ê»˜ ë‹¤ìš´ë¡œë“œ**í•œë‹¤.

**ìŠ¤í”„ë§ ë¶€íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬**

- spring-boot-starter-web
    - spring-boot-starter-tomcat: í†°ìº£ (ì›¹ì„œë²„)
    - spring-webmvc: ìŠ¤í”„ë§ ì›¹ MVC
- spring-boot-starter-thymeleaf: íƒ€ì„ë¦¬í”„ í…œí”Œë¦¿ ì—”ì§„(View)
- spring-boot-starter(ê³µí†µ): ìŠ¤í”„ë§ ë¶€íŠ¸ + ìŠ¤í”„ë§ ì½”ì–´ + ë¡œê¹…
    - spring-boot
        - spring-core
    - spring-boot-starter-logging
        - logback, slf4j

**í…ŒìŠ¤íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬**

- spring-boot-starter-test
    - junit: í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬
    - mockito: ëª© ë¼ì´ë¸ŒëŸ¬ë¦¬
    - assertj: í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì¢€ ë” í¸í•˜ê²Œ ì‘ì„±í•˜ê²Œ ë„ì™€ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬
    - spring-test: ìŠ¤í”„ë§ í†µí•© í…ŒìŠ¤íŠ¸ ì§€ì›

### thymeleaf í…œí”Œë¦¿ì—”ì§„ ë™ì‘

```java
@Controller
public class HelloController {

    @GetMapping("hello") // (1)
    public String hello(Model model) {
        model.addAttribute("data", "hello!!"); // (3)
        return "hello"; // (2)
    }
}
```

```html
<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Hello</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
</head>
<body>
<p th:text="'ì•ˆë…•í•˜ì„¸ìš”. ' + ${data}" >ì•ˆë…•í•˜ì„¸ìš”. ì†ë‹˜</p>
</body>
</html>
```

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-21 á„‹á…©á„Œá…¥á†« 11 12 10](https://github.com/Heo-y-y/SpringConquestRoadmap/assets/112863029/ba44ca1e-533f-4263-999a-5e873252742b)

ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ë¦¬í„´ ê°’ìœ¼ë¡œ ë¬¸ìë¥¼ ë°˜í™˜í•˜ë©´ **viewResolver**ê°€ í™”ë©´ì„ ì°¾ì•„ì„œ ì²˜ë¦¬í•´ì¤€ë‹¤.

(1) ìŠ¤í”„ë§ ë¶€íŠ¸ í…œí”Œë¦¿ì—”ì§„ ê¸°ë³¸ viewName ë§¤í•‘

(2) `model.addAttribute("data", "hello!!")`ëŠ” hello.htmlì˜ `<p th:text="'ì•ˆë…•í•˜ì„¸ìš”. ' + ${data}" >ì•ˆë…•í•˜ì„¸ìš”. ì†ë‹˜</p>` ì˜ í‚¤ ê°’ì´ ëœë‹¤.

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-21 á„‹á…©á„Œá…¥á†« 11 10 38](https://github.com/Heo-y-y/SpringConquestRoadmap/assets/112863029/6a9ea73c-195d-4bef-bc04-cca3d2924a61)

(3) resources: templates/ + {ViewName} + .html â† ìœ„ ì½”ë“œì—ì„œëŠ” hello.htmlì„ ì°¾ëŠ”ë‹¤.

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-21 á„‹á…©á„Œá…¥á†« 11 07 43](https://github.com/Heo-y-y/SpringConquestRoadmap/assets/112863029/852c9ed2-913a-45e6-b45c-ce54f167cd88)

### ì½˜ì†”ë¡œ ë¹Œë“œ í•˜ëŠ” ë²•

1. `./gradlew build`
2. `cd build/libs`
3. `java - jar hello-spring-0.0.1-SNAPSHOT.jar`
4. ì‹¤í–‰ í™•ì¸ í›„ ì¢…ë£Œì‹œì—ëŠ” `control + c`

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-21 á„‹á…©á„Œá…¥á†« 11 29 20](https://github.com/Heo-y-y/SpringConquestRoadmap/assets/112863029/b981d011-6533-4530-a74c-cb500ba93534)

![ìŠ¤í¬á„…á…µá†«á„‰á…£á†º 2023-08-21 á„‹á…©á„Œá…¥á†« 11 30 09](https://github.com/Heo-y-y/SpringConquestRoadmap/assets/112863029/493c2782-509a-4d6d-88d8-6380faf84a6d)


**ì£¼ì˜ ì‚¬í•­**

ë§Œì•½ì— ì¸í…”ë¦¬ì œì´ì—ì„œ ì‹¤í–‰ ì¤‘ì¸ ê²½ìš° ì‘ë™ì„ ì •ì§€ ì‹œí‚¤ê³ , ì§„í–‰í•´ì•¼ í•œë‹¤.

## ìŠ¤í”„ë§ ì›¹ ê°œë°œ ê¸°ì´ˆ

### ì •ì  ì»¨í…ì¸ 

íŒŒì¼ì„ ê·¸ëŒ€ë¡œ ê³ ê°ì—ê²Œ ì „ë‹¬í•´ì£¼ëŠ” ê²ƒì´ë‹¤.

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-21 á„‹á…©á„’á…® 6 15 26](https://github.com/Heo-y-y/SpringConquestRoadmap/assets/112863029/430ff6eb-c29d-4f00-8cf9-7fd9d74c733d)

ë‚´ì¥ í†°ì¼“ì—ì„œ ìš”ì²­ì„ ë°›ê³ , ìŠ¤í”„ë§ì—ì„œ ì»¨íŠ¸ë¡¤ëŸ¬ì— hello-staticì´ ìˆëŠ”ì§€ ê²€ì‚¬í•œë‹¤.(**ì»¨íŠ¸ë¡¤ëŸ¬ ìš°ì„ ê¶Œ**)

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-21 á„‹á…©á„’á…® 6 20 56](https://github.com/Heo-y-y/SpringConquestRoadmap/assets/112863029/6a9c4991-1fc9-4d0e-a57a-0db6e19e6985)

ì—†ìœ¼ë©´, ìœ„ ê·¸ë¦¼ ì²˜ëŸ¼ resources ë‚´ë¶€ì— ìˆëŠ” hello-staticì„ ì°¾ëŠ”ë‹¤.

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-21 á„‹á…©á„’á…® 6 18 22](https://github.com/Heo-y-y/SpringConquestRoadmap/assets/112863029/9ebce72a-109a-4c69-9692-0226bd9edf43)

í•´ë‹¹ ìœ„ì¹˜ë¥¼ ì°¾ì•„ì„œ ì •ì  ì»¨í…ì¸ ë¥¼ ë³´ì—¬ì¤€ë‹¤.

### MVCì™€ í…œí”Œë¦¿ ì—”ì§„

**ì„œë²„ì—ì„œ ë³€í˜•ì„ í•´ì„œ HTMLì„ ë°”ê¿”ì„œ ë‚´ë ¤ì£¼ëŠ” ë°©ì‹**ì´ë‹¤.

- **MVC(Model, View, Controller)**
    - View: í™”ë©´ì„ ê·¸ë¦¬ëŠ” ê²ƒë§Œ ì§‘ì¤‘í•´ì•¼ í•œë‹¤.
    - Model, Controller: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ê³¼ ê´€ë ¨ì´ ìˆê±°ë‚˜ ë‚´ë¶€ì ì¸ ë¶€ë¶„ì„ ì²˜ë¦¬í•˜ëŠ” ê²ƒì— ì§‘ì¤‘í•´ì•¼ í•œë‹¤.

```java
@GetMapping("hello-mvc")
    public String helloMvc(@RequestParam("name") String name, Model model) {
        model.addAttribute("name", name);
        return "hello-template";
    }
```

```html
<html xmlns:th="http://www.thymeleaf.org">
<body>
<p th:text="'hello ' + ${name}">hello! empty</p> //(1)
</body>
</html>
```

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-21 á„‹á…©á„’á…® 6 38 09](https://github.com/Heo-y-y/SpringConquestRoadmap/assets/112863029/2662f545-d7d0-40ce-be76-0986c5a6a5cf)

`@RequestParam(â€nameâ€)`ì€ (1)ì˜ `${name}` ì•ˆìœ¼ë¡œ ë“¤ì–´ê°€ê²Œ ëœë‹¤. ì¦‰, nameì˜ ê°’ì„ springìœ¼ë¡œ ë„£ì–´ì£¼ë©´, ì•„ë˜ ê·¸ë¦¼ì²˜ëŸ¼ `"'hello ' + ${name}"` = hello springìœ¼ë¡œ ë‚˜ì˜¤ëŠ” ê²ƒì´ë‹¤.

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-21 á„‹á…©á„’á…® 6 36 19](https://github.com/Heo-y-y/SpringConquestRoadmap/assets/112863029/c482ee47-0442-4547-8980-922257d68fe0)

### API

ì„œë²„ë¼ë¦¬ í†µì‹ í•  ë•Œ(ë°ì´í„°ê°€ íë¥¼ ë•Œ)

```java
		@GetMapping("hello-string")
    @ResponseBody //(1)
    public String helloString(@RequestParam("name") String name) {
        return "hello" + name;
    }

    @GetMapping("hello-api")
    @ResponseBody // ì ìš©
    public Hello helloApi(@RequestParam("name") String name) {
        Hello hello = new Hello();
        hello.setName(name);
        return hello; // ê°ì²´ ë°˜í™˜
    }

    static class Hello {
        private String name;

        public String getName() {
            return name;
        }

        public void setName(String name) {
            this.name = name;
        }
    }
```

(1)ì€ ì‘ë‹µ ë°”ë””ì— ì´ ë‚´ìš©ì„ ì§ì ‘ ë„£ì–´ ì£¼ê² ë‹¤ëŠ” ë§ì´ë‹¤.

ìœ„ ì½”ë“œì²˜ëŸ¼ **ê°ì²´ë¥¼ ë°˜í™˜**í•˜ê³  `@ResponseBody`ë¥¼ ì ìš©í•˜ë©´ ê¸°ë³¸ìœ¼ë¡œ **JSONì„ ë°˜í™˜**í•œë‹¤.

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-21 á„‹á…©á„’á…® 9 11 09](https://github.com/Heo-y-y/SpringConquestRoadmap/assets/112863029/17d63e96-c34e-4d23-8a1d-f66373686a60)

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-21 á„‹á…©á„’á…® 9 08 07](https://github.com/Heo-y-y/SpringConquestRoadmap/assets/112863029/625e7713-6e9c-4751-bc5f-198bf4599a51)

**MVC**ëŠ” **viewResolver**ì— ë˜ì§€ì§€ë§Œ, `@ResponseBody`ë¥¼ ì‚¬ìš©í•˜ë©´ **HttpMessageCpmverter**ê°€ ë™ì‘í•˜ê³ , **ê°ì²´ë¥¼ JSON ë°©ì‹ìœ¼ë¡œ ë°ì´í„°ë¥¼ ë§Œë“¤ì–´ì„œ HTTP ì‘ë‹µ**ì— ë°˜ì‘í•œë‹¤.

**ê¸°ë³¸ ë¬¸ìì²˜ë¦¬**ëŠ” **StringHttpMessageConverter**ê°€ ì²˜ë¦¬í•˜ê³ , **ê¸°ë³¸ ê°ì²´ì²˜ë¦¬**ëŠ” **MappingJackson2HttpMessageConverter**ê°€ ì„ íƒì´ ëœë‹¤.

### ì¼ë°˜ì ì¸ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ê³„ì¸µ êµ¬ì¡°

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-21 á„‹á…©á„’á…® 9 12 21](https://github.com/Heo-y-y/SpringConquestRoadmap/assets/112863029/5fee8948-93a7-447a-a931-46b9ab59e133)

- **ì»¨íŠ¸ë¡¤ëŸ¬**: ì›¹ MVCì˜ ì»¨íŠ¸ë¡¤ëŸ¬ ì—­í• 
- **ì„œë¹„ìŠ¤**: í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ êµ¬í˜„
- **ë¦¬í¬ì§€í† ë¦¬**: ë°ì´í„°ë² ì´ìŠ¤ì— ì ‘ê·¼, ë„ë©”ì¸ ê°ì²´ë¥¼ DBì— ì €ì¥í•˜ê³  ê´€ë¦¬
- **ë„ë©”ì¸**: ë¹„ì¦ˆë‹ˆìŠ¤ ë„ë©”ì¸ ê°ì²´

### í…ŒìŠ¤íŠ¸ ì½”ë“œ

```java
class MemoryMemberRepositoryTest {
    MemoryMemberRepository repository = new MemoryMemberRepository();

    @Test
    public void save() {
        Member member = new Member();
        member.setName("heo");

        repository.save(member);

        Member result = repository.findById(member.getId()).get();
        assertThat(member).isEqualTo(result);
    }

    @Test
    public void findByName() {
        Member member = new Member();
        member.setName("heo");
        repository.save(member);

        Member member1 = new Member();
        member1.setName("heo1");
        repository.save(member1);

        Member result = repository.findByName("heo1").get();
        assertThat(result).isEqualTo(member1);
    }

    @Test
    public void findAll() {
        Member member1 = new Member();
        member1.setName("heo1");
        repository.save(member1);

        Member member2 = new Member();
        member2.setName("heo2");
        repository.save(member2);

        List <Member> result = repository.findAll();
        assertThat(result.size()).isEqualTo(2);
    }
}
```

ìœ„ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì „ì²´ ì‹¤í–‰ ì‹œí‚¤ë©´, ì•„ë˜ ê·¸ë¦¼ì²˜ëŸ¼ ì—ëŸ¬ê°€ ë‚˜ì˜¨ë‹¤.

![ìŠ¤í¬á„…á…µá†«á„‰á…£á†º 2023-08-21 á„‹á…©á„’á…® 9 44 44](https://github.com/Heo-y-y/SpringConquestRoadmap/assets/112863029/657aa095-b11d-4437-85bc-9f99b385f576)

í…ŒìŠ¤íŠ¸ ì½”ë“œëŠ” ëª¨ë“  ìˆœì„œê°€ ë³´ì¥ì´ ì•ˆëœë‹¤.

ê·¸ë˜ì„œ ì•„ë˜ì˜ ì½”ë“œë¥¼ **í…ŒìŠ¤íŠ¸ì½”ë“œì— ì‘ì„±í•˜ê³  í•˜ë‚˜ì˜ í…ŒìŠ¤íŠ¸ê°€ ëë‚  ë•Œë§ˆë‹¤ ì €ì¥ì†Œë¥¼ ê¹¨ë—í•˜ê²Œ ì§€ì›Œì£¼ì–´ì•¼ í•œë‹¤**.

```java
		@AfterEach
    public void afterEach() {
        repository.clearStore();
    }
```

## ìŠ¤í”„ë§ ë¹ˆê³¼ ì˜ì¡´ ê´€ê³„

```java
@Controller
public class MemberController {
    private final MemberService memberService;

    @Autowired //(1)
    public MemberController(MemberService memberService) {
        this.memberService = memberService;
    }
}
```

(1)ì²˜ëŸ¼ ìƒì„±ìì— `@Autowired`ê°€ ìˆìœ¼ë©´ **ìŠ¤í”„ë§**ì´ **ì—°ê´€ëœ ê°ì²´ë¥¼ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì—ì„œ ì°¾ì•„ì„œ ë„£ì–´**ì¤€ë‹¤. ì´ë ‡ê²Œ **ê°ì²´ ì˜ì¡´ê´€ê³„ë¥¼ ì™¸ë¶€ì—ì„œ ë„£ì–´ì£¼ëŠ” ê²ƒ**ì„ **DI(Dependency Injection) ì˜ì¡´ì„± ì£¼ì…**ì´ë¼ê³  í•œë‹¤.

ë§Œì•½ **ìƒì„±ìê°€ 1ê°œë§Œ** ìˆì„ ê²½ìš° `@Autowired`ëŠ” **ìƒëµ**í•´ë„ ëœë‹¤.

ê·¸ë¦¬ê³  `@Autowired`ë¥¼ í†µí•œ DIëŠ” **ìŠ¤í”„ë§ì´ ê´€ë¦¬í•˜ëŠ” ê°ì²´ì—ì„œë§Œ ë™ì‘**í•œë‹¤. ì¦‰, ìœ„ì— ì½”ë“œì—ì„œ `@Controller`ê°€ ì—†ëŠ” ìƒí™©ì—ì„œ `@Autowired`ë¥¼ ì‚¬ìš©í•˜ë©´ ë™ì‘í•˜ì§€ ì•ŠëŠ”ë‹¤.

```java
// @Service (2)
public class MemberService {
    private final MemberRepository memberRepository;

    @Autowired
    public MemberService(MemberRepository memberRepository) {
        this.memberRepository = memberRepository;
    }
```

í˜„ì¬ ìœ„ì— ë‘ ì½”ë“œì™€ ê°™ì€ ìƒí™©ì—ì„œ ì‹¤í–‰ ì‹œí‚¤ë©´ ì•„ë˜ì™€ ê°™ì€ ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤.

![ìŠ¤í¬á„…á…µá†«á„‰á…£á†º 2023-08-23 á„‹á…©á„’á…® 11 10 53](https://github.com/Heo-y-y/SpringConquestRoadmap/assets/112863029/74868af1-eabc-4c55-b2a2-a0d1789b9ac6)

ì´ìœ ëŠ” í˜„ì¬ MemberServiceê°€ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡ë˜ì–´ ìˆì§€ ì•Šê¸° ë•Œë¬¸ì´ë‹¤.

MemberService í´ë˜ìŠ¤ì— (2)ì˜ ì£¼ì„ì„ í’€ì–´ì£¼ë©´ í•´ê²°ì´ ëœë‹¤. ê·¸ëŸ¬ë©´ **ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡**í•´ì¤€ë‹¤. 

### **ìŠ¤í”„ë§ ë¹ˆì„ ë“±ë¡í•˜ëŠ” 2ê°€ì§€ ë°©ë²•**

1. **ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ê³¼ ìë™ ì˜ì¡´ê´€ê³„ ì„¤ì •**

**ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº” ì›ë¦¬**

- `@Component` ì–´ë…¸í…Œì´ì…˜ì´ ìˆìœ¼ë©´ **ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ìë™ ë“±ë¡**ëœë‹¤.
- `@Service`ê°€ ìŠ¤í”„ë§ **ë¹ˆìœ¼ë¡œ ìë™ ë“±ë¡**ëœ ì´ìœ ë„ **ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº” ë•Œë¬¸**ì´ë‹¤.
    - ì¦‰, `@Controller`, `@Service`, `@Repository` ë“± `@Componet`ë¥¼ **í¬í•¨í•˜ëŠ” ì–´ë…¸í…Œì´ì…˜**ì€ **ìŠ¤í”„ë§ë¹ˆìœ¼ë¡œ ìë™ ë“±ë¡** ëœë‹¤.

![ìŠ¤í¬á„…á…µá†«á„‰á…£á†º 2023-08-23 á„‹á…©á„’á…® 11 17 23](https://github.com/Heo-y-y/SpringConquestRoadmap/assets/112863029/b4d21dad-975c-4d77-b753-b2e5f4a59303)

ì¶”ê°€ë¡œ, **ìŠ¤í”„ë§**ì€ **ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ìŠ¤í”„ë§ ë¹ˆì„ ë“±ë¡**í•  ë•Œ, ê¸°ë³¸ìœ¼ë¡œ **ì‹±ê¸€í†¤ìœ¼ë¡œ ë“±ë¡**í•œë‹¤. ë”°ë¼ì„œ ê°™ì€ ìŠ¤í”„ë§ ë¹ˆì´ë©´ ëª¨ë‘ ê°™ì€ ì¸ìŠ¤í„´ìŠ¤ë‹¤.

1. **ìë°” ì½”ë“œë¡œ ì§ì ‘ ìŠ¤í”„ë§ ë¹ˆ ë“±ë¡**

ë§Œì•½ì— MemberController í´ë˜ìŠ¤ì—ë§Œ `@Controller`ê°€ ìˆê³  ë‚˜ë¨¸ì§€ MemberService í´ë˜ìŠ¤ì™€ MemoryMemberRepository í´ë˜ìŠ¤ì— `@Service, @Reposiotry`ê°€ ì—†ë‹¤ê³  ê°€ì •í•˜ì.

ìë°” ì½”ë“œë¡œ ì§ì ‘ ë“±ë¡í•  ê²½ìš°ì—ëŠ” ì•„ë˜ ì½”ë“œì²˜ëŸ¼ **SpringConfig**ë¼ëŠ” í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì–´ ë”°ë¡œ ë§Œë“¤ì–´ì„œ `@Bean`ìœ¼ë¡œ **ì§ì ‘ ë“±ë¡**í•´ì¤€ë‹¤.

ì‚¬ì‹¤ í˜„ì¬ëŠ” ë“±ë¡í•´ì•¼í•  í´ë˜ìŠ¤ê°€ ë§ì´ ì—†ì–´ì„œ í¸í•´ë³´ì´ì§€ë§Œ ë§ì•„ì§ˆ ê²½ìš°ì—ëŠ” í™•ì‹¤íˆ **ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ì„ ì´ìš”í•œ ìë™ ì˜ì¡´ê´€ê³„ ì„¤ì •ì´ í¸ë¦¬**í•´ ë³´ì¸ë‹¤.

```java
@Configuration
public class SpringiCongfig {

    @Bean
    public MemberService memberService() {
        return new MemberService(memberRepository());
    }

    @Bean
    public MemberRepository memberRepository() {
        return new MemoryMemberRepository();
    }
}
```

## ìŠ¤í”„ë§ DB ì ‘ê·¼ ê¸°ìˆ 

### H2 ë°ì´í„°ë² ì´ìŠ¤

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-24 á„‹á…©á„’á…® 4 03 17](https://github.com/Heo-y-y/SpringConquestRoadmap/assets/112863029/ea03b85c-62c9-42e9-a3e1-254de5a5812b)

`h2/bin` ìœ¼ë¡œ ê°€ì„œ `./h2.sh` ëª…ë ¹ì–´ë¥¼ ì¹˜ë©´ **h2 ë°ì´í„°ë² ì´ìŠ¤ê°€ ì‹¤í–‰**ëœë‹¤.

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-24 á„‹á…©á„’á…® 4 04 42](https://github.com/Heo-y-y/SpringConquestRoadmap/assets/112863029/36bc71b9-cb77-48ed-86e0-42c5753eabcb)

ì•„ë˜ ì½”ë“œë¥¼ í†µí•´ í…Œì´ë¸”ì„ ë§Œë“¤ ìˆ˜ ìˆë‹¤.

```java
drop table if exists member CASCADE;
create table member
(
 id bigint generated by default as identity,
 name varchar(255),
 primary key (id)
);
```

ê·¸ë¦¬ê³  `insert into member(name) values('heo')` í•´ë‹¹ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ë©´ member í…Œì´ë¸”ì˜ name ì»¬ëŸ¼ì˜ ê°’(heo)ì„ ë„£ì„ ìˆ˜ ìˆë‹¤.

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-24 á„‹á…©á„’á…® 4 13 55](https://github.com/Heo-y-y/SpringConquestRoadmap/assets/112863029/3438fa53-e38a-4d57-b2ab-d039b74bcf07)

ì¡°íšŒí•˜ë©´ heoê°€ ë“¤ì–´ê°„ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-24 á„‹á…©á„’á…® 4 15 47](https://github.com/Heo-y-y/SpringConquestRoadmap/assets/112863029/00d56da2-9201-420c-9737-4776f23de017)

### ìˆœìˆ˜ JDBC

ê³ ì „ ë°©ì‹ì´ê¸° ë•Œë¬¸ì— ì§€ê¸ˆì€ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤. ì˜ˆì „ì— ê°œë°œì ë¶„ë“¤ì€ ì´ë ‡ê²Œ ë‹¤ ì§ì ‘ ì‘ì„±í–ˆë‹¤ê³  ì•Œì•„ë§Œ ê°€ìâ€¦.

ìš°ì„  **í™˜ê²½ ì„¤ì •**ì„ í•´ì•¼í•˜ëŠ”ë°, `build.gradle` íŒŒì¼ì— **jdbc, h2 ë°ì´í„°ë² ì´ìŠ¤ ê´€ë ¨ ë¼ì´ë¸ŒëŸ¬ë¦¬**ë¥¼ ì¶”ê°€í•œë‹¤.

```java
implementation 'org.springframework.boot:spring-boot-starter-jdbc'
runtimeOnly 'com.h2database:h2'
```

ê·¸ë¦¬ê³  **ìŠ¤í”„ë§ ë¶€íŠ¸ ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì„¤ì •ì„ ì¶”ê°€**í•˜ëŠ”ë° ì´ê±´ `application.properties`ì—ì„œ ì„¤ì •í•˜ë©´ ëœë‹¤.

```java
spring.datasource.url=jdbc:h2:tcp://localhost/~/test //(1)
spring.datasource.driver-class-name=org.h2.Driver //(2)
```

(1)ì€ h2 url ê²½ë¡œì™€ ë™ì¼í•˜ê²Œ ì‘ì„±í•˜ë©´ ëœë‹¤.

(2)ëŠ” h2 dbì— ì ‘ê·¼í• ë•Œ driverê°€ í•„ìš”í•˜ê¸° ë•Œë¬¸ì— ì„¤ì •ì„ í•´ì•¼í•œë‹¤.

ì•„ë˜ì™€ ê°™ì€ ì½”ë“œë¥¼ ì§ì ‘ êµ¬í˜„ í–ˆë‹¤ê³  í•œë‹¤â€¦. ì˜¤ìš°â€¦..

```java
package hello.hellospring.repository;

import hello.hellospring.domain.Member;
import org.springframework.jdbc.datasource.DataSourceUtils;

import javax.sql.DataSource;
import java.sql.*;
import java.util.ArrayList;
import java.util.List;
import java.util.Optional;

public class JdbcMemberRepository implements MemberRepository {

    private final DataSource dataSource;

    public JdbcMemberRepository(DataSource dataSource) {
        this.dataSource = dataSource;
    }

    @Override
    public Member save(Member member) {
        String sql = "insert into member(name) values(?)";
        Connection conn = null;
        PreparedStatement pstmt = null;
        ResultSet rs = null;
        
        try {
            conn = getConnection();
            pstmt = conn.prepareStatement(sql, Statement.RETURN_GENERATED_KEYS);
            pstmt.setString(1, member.getName());
            pstmt.executeUpdate();
            rs = pstmt.getGeneratedKeys();

            if (rs.next()) {
                member.setId(rs.getLong(1));
            } else {
                throw new SQLException("id ì¡°íšŒ ì‹¤íŒ¨");
            }
            return member;
        } catch (Exception e) {
            throw new IllegalStateException(e);
        } finally {
            close(conn, pstmt, rs);
        }
    }
    @Override
    public Optional<Member> findById(Long id) {
        String sql = "select * from member where id = ?";
        Connection conn = null;
        PreparedStatement pstmt = null;
        ResultSet rs = null;
        try {
            conn = getConnection();
            pstmt = conn.prepareStatement(sql);
            pstmt.setLong(1, id);
            rs = pstmt.executeQuery();
            if(rs.next()) {
                Member member = new Member();
                member.setId(rs.getLong("id"));
                member.setName(rs.getString("name"));
                return Optional.of(member);
            } else {
                return Optional.empty();
            }
        } catch (Exception e) {
            throw new IllegalStateException(e);
        } finally {
            close(conn, pstmt, rs);
        }
    }
    @Override
    public List<Member> findAll() {
        String sql = "select * from member";
        Connection conn = null;
        PreparedStatement pstmt = null;
        ResultSet rs = null;
        try {
            conn = getConnection();
            pstmt = conn.prepareStatement(sql);
            rs = pstmt.executeQuery();
            List<Member> members = new ArrayList<>();
            while(rs.next()) {
                Member member = new Member();
                member.setId(rs.getLong("id"));
                member.setName(rs.getString("name"));
                members.add(member);
            }
            return members;
        } catch (Exception e) {
            throw new IllegalStateException(e);
        } finally {
            close(conn, pstmt, rs);
        }
    }
    @Override
    public Optional<Member> findByName(String name) {
        String sql = "select * from member where name = ?";
        Connection conn = null;
        PreparedStatement pstmt = null;
        ResultSet rs = null;
        try {
            conn = getConnection();
            pstmt = conn.prepareStatement(sql);
            pstmt.setString(1, name);
            rs = pstmt.executeQuery();
            if(rs.next()) {
                Member member = new Member();
                member.setId(rs.getLong("id"));
                member.setName(rs.getString("name"));
                return Optional.of(member);
            }
            return Optional.empty();
        } catch (Exception e) {
            throw new IllegalStateException(e);
        } finally {
            close(conn, pstmt, rs);
        }
    }
    private Connection getConnection() {
        return DataSourceUtils.getConnection(dataSource);
    }
    private void close(Connection conn, PreparedStatement pstmt, ResultSet rs)
    {
        try {
            if (rs != null) {
                rs.close();
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
        try {
            if (pstmt != null) {
                pstmt.close();
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
        try {
            if (conn != null) {
                close(conn);
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
    private void close(Connection conn) throws SQLException {
        DataSourceUtils.releaseConnection(conn, dataSource);
    }
}
```

ì—¬ê¸°ì„œ ì‚¬ìš©í•œ `DataSource`ëŠ” **ë°ì´í„°ë² ì´ìŠ¤ ì»¤ë„¥ì…˜ì„ íšë“¤í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ê°ì²´**ì´ë‹¤.

**ìŠ¤í”„ë§ ë¶€íŠ¸**ëŠ” **ë°ì´í„°ë² ì´ìŠ¤ ì»¤ë„¥ì…˜ ì •ë³´ë¥¼ ë°”íƒ•**ìœ¼ë¡œ **DataSource**ë¥¼ **ìƒì„±**í•˜ê³  **ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë§Œë“¤ì–´ ë‘”ë‹¤**.

**SpringConfig** í´ë˜ìŠ¤ì˜ **ì¥ì **ì´ ì—¬ê¸°ì„œ ë‚˜ì˜¤ëŠ”ë°, í˜„ì¬ëŠ” `MemoryMemberRepository()`ë¥¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤. ê·¸ëŸ°ë° ìš°ë¦° ìƒˆë¡œ ë§Œë“  **JdbcMemberRepository**ë¥¼ ì‚¬ìš©í•  ê²ƒì´ë‹¤. 

```java
@Configuration
public class SpringiCongfig {
		//private DataSource dataSource; //

    //@Autowired
    //public SpringiCongfig(DataSource dataSource) {
    //    this.dataSource = dataSource;
    //}

    @Bean
    public MemberService memberService() {
        return new MemberService(memberRepository());
    }

    @Bean
    public MemberRepository memberRepository() {
        return new MemoryMemberRepository();
		//		return new JdbcMemberRepository(dataSource);
    }
}
```

ìœ„ì— ì£¼ì„ ëœ ë¶€ë¶„ë§Œ í’€ì–´ì£¼ê³ , `return new MemoryMemberRepository();`ë¥¼ ì£¼ì„ ì²˜ë¦¬í•˜ë©´ **JdbcMemberRepository**ë¡œ ì‰½ê²Œ êµì²´í•  ìˆ˜ ìˆë‹¤.

ì—¬ê¸°ì„œ **Spring**ì„ ì“°ëŠ” ì´ìœ ê°€ ë³´ì´ëŠ”ë°, ìŠ¤í”„ë§ì€ **ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ**ê°€ **ì§€ì›**ì„ í•´ì£¼ê¸° ë•Œë¬¸ì— ê°œë°œìê°€ ê°œë°œì— ì§‘ì¤‘í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ê²ƒì´ë‹¤.

- **OCP(ê°œë°© íì‡„ ì›ì¹™)**
    - í™•ì¥ì—ëŠ” ì—´ë ¤ìˆê³ , ìˆ˜ì • ë³€ê²½ì—ëŠ” ë‹«í˜€ìˆë‹¤.
- **DI(ì˜ì¡´ì„± ì£¼ì…)**
    - ê¸°ì¡´ ì½”ë“œë¥¼ ì „í˜€ ì†ëŒ€ì§€ ì•Šê³ , ì„¤ì •ë§Œìœ¼ë¡œ êµ¬í˜„ í´ë˜ìŠ¤ë¥¼ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.

### ìŠ¤í”„ë§ í†µí•© í…ŒìŠ¤íŠ¸

**ì „ì— í…ŒìŠ¤íŠ¸ ì½”ë“œëŠ” ìˆœìˆ˜ ìë°” í…ŒìŠ¤íŠ¸**ì˜€ê³ , ì§€ê¸ˆ í…ŒìŠ¤íŠ¸ ì½”ë“œëŠ” **ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì™€ DBê¹Œì§€ ì—°ê²°í•œ í†µí•© í…ŒìŠ¤íŠ¸**ë‹¤.

```java
@SpringBootTest //(1)
@Transactional //(2)
class MemberServiceIntegrationTest {
    @Autowired
    MemberService memberService;
    @Autowired
    MemberRepository memberRepository;

    @Test
    void join() {
        // given
        Member member = new Member();
        member.setName("hello");
        // when
        Long saveId = memberService.join(member);
        // then
        Member findMember = memberService.findOne(saveId).get();
        assertThat(member.getName()).isEqualTo(findMember.getName());
    }

    @Test
    void existMember() {
        // given
        Member member = new Member();
        member.setName("spring");
        Member member1 = new Member();
        member1.setName("spring");
        // when
        memberService.join(member);
        IllegalStateException e = assertThrows(IllegalStateException.class, () -> memberService.join(member1));
        assertThat(e.getMessage()).isEqualTo("ì´ë¯¸ ì¡´ì¬í•˜ëŠ” íšŒì›ì´ë‹¤.");
    }
```

(1)ì˜ `@SpringBootTest` ì–´ë…¸í…Œì´ì…˜ì€ **ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì™€ í…ŒìŠ¤íŠ¸ë¥¼ í•¨ê»˜ ì‹¤í–‰**ì‹œì¼œì¤€ë‹¤.

(2)ì˜ `@Transactional` ì–´ë…¸í…Œì´ì…˜ì´ ë§Œì•½ **í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ì— ìˆìœ¼ë©´**, í…Œ**ìŠ¤íŠ¸ ì‹œì‘ ì „ì— íŠ¸ëœì­ì…˜ì„ ì‹œì‘**í•˜ê³ , **í…ŒìŠ¤íŠ¸ ì™„ë£Œ í›„** í•­ìƒ **ë¡¤ë°±**í•œë‹¤. ì´ë ‡ê²Œ í•˜ë©´ DBì— ë°ì´í„°ê°€ ì—†ì–´ì ¸ì„œ ë‹¤ìŒ í…ŒìŠ¤íŠ¸ì— ì˜í–¥ì„ ì£¼ì§€ ì•ŠëŠ”ë‹¤.

í•˜ì§€ë§Œ ì´ëŸ¬í•œ í†µí•© í…ŒìŠ¤íŠ¸ë³´ë‹¤ëŠ” **ë‹¨ìœ„ í…ŒìŠ¤íŠ¸**ë¥¼ ë” ì˜ ë§Œë“œëŠ”ê²Œ ì¤‘ìš”í•˜ë‹¤.

### ìŠ¤í”„ë§ JdbcTemplate

JdbcTemplateê°™ì€ ê²½ìš°ì—ëŠ” ìˆœìˆ˜ Jdbcì™€ ë™ì¼í•œ í™˜ê²½ì„¤ì •ì„ í•˜ë©´ ëœë‹¤.

ìŠ¤í”„ë§ JdbcTemplateê³¼ MyBatis ê°™ì€ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” JDBC APIì—ì„œ ë³¸ ë°˜ë³µ ì½”ë“œë¥¼ ëŒ€ë¶€ë¶„ ì œê°€í•´ì¤€ë‹¤. í•˜ì§€ë§Œ SQLì€ ì§ì ‘ ì‘ì„±í•´ì•¼ í•œë‹¤.

```java
public class JdbcTemplateMemberRepository implements MemberRepository {
    private final JdbcTemplate jdbcTemplate;

    public JdbcTemplateMemberRepository(DataSource dataSource) {
        jdbcTemplate = new JdbcTemplate(dataSource);
    }

    @Override
    public Member save(Member member) {
        SimpleJdbcInsert jdbcInsert = new SimpleJdbcInsert(jdbcTemplate);
        jdbcInsert.withTableName("member").usingGeneratedKeyColumns("id");
        Map<String, Object> parameters = new HashMap<>();
        parameters.put("name", member.getName());
        Number key = jdbcInsert.executeAndReturnKey(new
                MapSqlParameterSource(parameters));
        member.setId(key.longValue());
        return member;
    }
    @Override
    public Optional<Member> findById(Long id) {
        List<Member> result = jdbcTemplate.query("select * from member where id = ?", memberRowMapper(), id);
        return result.stream().findAny();
    }
    @Override
    public List<Member> findAll() {
        return jdbcTemplate.query("select * from member", memberRowMapper());
    }
    @Override
    public Optional<Member> findByName(String name) {
        List<Member> result = jdbcTemplate.query("select * from member where name = ?", memberRowMapper(), name);
        return result.stream().findAny();
    }
    private RowMapper<Member> memberRowMapper() {
        return (rs, rowNum) -> {
            Member member = new Member();
            member.setId(rs.getLong("id"));
            member.setName(rs.getString("name"));
            return member;
        };
    }
}
```

ë§ˆì°¬ê°€ì§€ë¡œ **SpringConfig** í´ë˜ìŠ¤ì—ì„œ `JdbcTemplateMemberRepository()`ë¥¼ ìƒì„±í•´ì£¼ë©´ ëœë‹¤.

```java
@Bean
 public MemberRepository memberRepository() {
// return new MemoryMemberRepository();
// return new JdbcMemberRepository(dataSource);
 return new JdbcTemplateMemberRepository(dataSource);
 }
}
```

### JPA

ì´ì œ ê¸°ì¡´ì˜ ë°˜ë³µ ì½”ë“œëŠ” ë¬¼ë¡ ì´ê³ , **SQLê¹Œì§€ ìë™**ìœ¼ë¡œ í•´ì£¼ëŠ” **JPA**ë¥¼ ì•Œì•„ë³´ì.

**JPA**ëŠ” **SQLê³¼ ë°ì´í„° ì¤‘ì‹¬ì˜ ì„¤ê³„ì—ì„œ ê°ì²´ ì¤‘ì‹¬ì˜ ì„¤ê³„**ë¡œ íŒ¨ëŸ¬ë‹¤ì„ì„ ì „í™˜í•  ìˆ˜ ìˆë‹¤.

ì¦‰, ê°œë°œ ìƒìƒì„±ì„ í¬ê²Œ ë†’ì¼ ìˆ˜ ìˆë‹¤.

**JPA**ë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì€ ìš°ì„  `build.gradle`ì— **JPA, h2 ë°ì´í„°ë² ì´ìŠ¤ ë¼ì´ë¸ŒëŸ¬ë¦¬**ë¥¼ ì¶”ê°€í•œë‹¤.

```java
implementation 'org.springframework.boot:spring-boot-starter-data-jpa'
runtimeOnly 'com.h2database:h2'
```

ì—¬ê¸°ì„œ `spring-boot-starter-data-jpa`ëŠ” **ë‚´ë¶€ì— jdbc ê´€ë ¨ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ í¬í•¨**ë˜ê¸° ë•Œë¬¸ì— jdbcëŠ” ì‚­ì œí•´ë„ ëœë‹¤.

ê·¸ ë‹¤ìŒ `application.properties`ì— ì•„ë˜ ì½”ë“œë¥¼ ì¶”ê°€í•´ì¤€ë‹¤.

```java
spring.jpa.show-sql=true //(1)
spring.jpa.hibernate.ddl-auto=none //(2)
```

(1)ëŠ” **JPA**ì— ê´€ë ¨ë´ ì„¤ì •ì„ ì¶”ê°€í•˜ëŠ” ê²ƒì¸ë° **JPAê°€ ë‚ ë¦¬ëŠ” sqlë¥¼ ë³¼ ìˆ˜ ìˆë‹¤**.
(2)ëŠ” **JPA**ë¥¼ ì‚¬ìš©í•˜ë©´ í…Œì´ë¸”ì„ ë‹¤ ë§Œë“¤ì–´ ì£¼ëŠ”ë°, í˜„ì¬ëŠ” ì´ë¯¸ í…Œì´ë¸”ì„ ë§Œë“¤ì–´ì„œ **noneìœ¼ë¡œ í…Œì´ë¸”ì„ ëª»ë§Œë“¤ê²Œ í•˜ëŠ” ê²ƒ**ì´ë‹¤.
**create**ë¥¼ ì‚¬ìš©í•˜ë©´ ì—”í‹°í‹° ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ í…Œì´ë¸”ë„ ì§ì ‘ ìƒì„±í•´ì¤€ë‹¤.

```java
public class JpaMemberRepository implements MemberRepository{
   private final EntityManager em;

    public JpaMemberRepository(EntityManager em) {
        this.em = em;
    }

    @Override
    public Member save(Member member) {
         em.persist(member);
        return member;
    }

    @Override
    public Optional<Member> findById(Long id) {
        Member member = em.find(Member.class, id);
        return Optional.ofNullable(member);
    }

    @Override
    public Optional<Member> findByName(String name) {
        List<Member> result = em.createQuery("select m from Member m where m.name = :name", Member.class)
                .setParameter("name", name)
                .getResultList();
        return result.stream().findAny();
    }

    @Override
    public List<Member> findAll() {
        return em.createQuery("select m from Member m", Member.class)
                .getResultList();
    }
}
```

**JPA**ë€ **ì¸í„°í˜ì´ìŠ¤ë§Œ ì œê³µ**ë˜ëŠ” ê±°ê³ , **êµ¬í˜„ì²´**ë¡œ **í•˜ì´ë²„ë„¤ì´íŠ¸ ì´í´ë¦½ìŠ¤ ë“±ì„ ì‚¬ìš©**í•˜ëŠ” ê²ƒì´ë‹¤. ì¦‰, **JPA**ë€ **ìë°” ì§„ì˜ì˜ í‘œì¤€ ì¸í„°í˜ì´ìŠ¤**ê³ , **êµ¬í˜„ì€ ì—¬ëŸ¬ ì—…ì²´ë“¤ì´ í•˜ëŠ” ê²ƒ**ì´ë‹¤.

**JPAë¥¼ í†µí•œ ëª¨ë“  ë°ì´í„° ë³€ê²½ì€ íŠ¸ëœì­ì…˜ ì•ˆì—ì„œ ì‹¤í–‰í•´ì•¼ í•œë‹¤.**

**JPA**ëŠ” **ê°ì²´ë‘ ORMì´ë¼ëŠ” ê¸°ìˆ **ì´ë‹¤. 

**ORM**(Object-Relational Mapping)ì´ë€ **ê°ì²´ ê´€ê³„í˜• ë§¤í•‘**ì´ë‹¤.

ì¦‰, ê°œë°œìê°€ **ê°ì²´ ì§€í–¥ í”„ë¡œê·¸ë˜ë° ê°œë…ì„ ì‚¬ìš©**í•˜ì—¬ **ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ì™€ ìƒí˜¸ ì‘ìš©í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” í”„ë¡œê·¸ë˜ë° ê¸°ìˆ  ë˜ëŠ” ë„êµ¬**ì¸ ê²ƒì´ë‹¤.

### ìŠ¤í”„ë§ ë°ì´í„° JPA

ìŠ¤í”„ë§ ë¶€íŠ¸ì™€ JPAë§Œ ì‚¬ìš©í•´ë„ ê°œë°œ ìƒì‚°ì„±ì´ ë§ì´ ì¦ê°€í•œë‹¤. ì—¬ê¸°ì— ìŠ¤í”„ë§ ë°ì´í„° JPAë¥¼ ì‚¬ìš©í•˜ë©´, ë” í¸ë¦¬í•´ì§€ê³  ê°„í¸í•´ì§„ë‹¤. ë¦¬íŒŒì§€í† ë¦¬ì— êµ¬í˜„ í´ë˜ìŠ¤ ì—†ì´ ì¸í„°í˜ì´ìŠ¤ ë§Œìœ¼ë¡œ ê°œë°œì„ ì™„ë£Œí•  ìˆ˜ ìˆê²Œ ëœë‹¤. ê·¸ë¦¬ê³  ë°˜ë³µ ê°œë°œí•´ì˜¨ CRUD ê¸°ëŠ¥ë„ ìŠ¤í”„ë§ ë°ì´í„° JPAê°€ ëª¨ë‘ ì œê³µí•œë‹¤.

ì¦‰, **ìŠ¤í”„ë§ ë°ì´í„° JPA**ëŠ” **JPAë¥¼ í¸ë¦¬í•˜ê²Œ ì‚¬ìš©í•˜ë„ë¡ ë„ì™€ì£¼ëŠ” ê¸°ìˆ **ì´ë‹¤.

ì´ë¡œì¸í•´ ê°œë°œìëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ë¡œì§ì— ì§‘ì¤‘í•˜ì—¬ ê°œë°œì„ í•  ìˆ˜ ìˆë‹¤.

`build.gradle`ì˜ ì¢…ì†ì„± ì£¼ì…ì€ ê·¸ëŒ€ë¡œ JPAë¥¼ ì‚¬ìš©í•˜ë©´ ë˜ê³ , **ë ˆíŒŒì§€í† ë¦¬** ê°™ì€ ê²½ìš°ì—ëŠ” **ì¸í„°í˜ì´ìŠ¤**ë¡œ ë§Œë“¤ë©´ ëœë‹¤.

```java
public interface SpringDataJpaMemberRepository extends JpaRepository<Member, Long>, MemberRepository {
    @Override
    Optional<Member> findByName(String name);
}
```

ê·¸ë¦¬ê³  **SpringConfig**ì— **MemberRepository**ë¥¼ ê·¸ëŒ€ë¡œ **DI**ë¥¼ ë°›ì•„ì™€ **MemberService** ì•ˆì— ë„£ì–´ì£¼ë©´ ëœë‹¤.

```java
@Configuration
public class SpringiCongfig {
    private final MemberRepository memberRepository;

    @Autowired
    public SpringiCongfig(MemberRepository memberRepository) {
        this.memberRepository = memberRepository;
    }

    @Bean
    public MemberService memberService() {
        return new MemberService(memberRepository);
    }
```

ì´ë ‡ê²Œ í•˜ë©´ **ìŠ¤í”„ë§ ë°ì´í„° JPA**ê°€ **SpringDataJpaMemberRepository**ë¥¼ **ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ìë™ ë“±ë¡**í•´ì¤€ë‹¤.

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-24 á„‹á…©á„’á…® 7 33 55](https://github.com/Heo-y-y/SpringConquestRoadmap/assets/112863029/bd336b4b-429e-445a-8047-311f9f636cc8)

ì‹¬ì§€ì–´ **ìŠ¤í”„ë§ ë°ì´í„° JPA**ëŠ” **ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•œ ê¸°ë³¸ì ì¸ CRUDë¥¼ ì œê³µ**í•´ ì¤˜ì„œ ê·¸ë¦¼ì—ì„œ ë³´ëŠ” ê²ƒì²˜ëŸ¼ ì‰½ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ ê³µí†µì ì¸ CRUDë§ê³  **ì»¤ìŠ¤í…€ìœ¼ë¡œ ë§Œë“¤ì–´ì•¼ í•  ê²½ìš°**ì—ëŠ” **ë©”ì„œë“œ ì´ë¦„ ë§Œìœ¼ë¡œ ì¡°íšŒ ê¸°ëŠ¥ì„ ì œê³µ**í•œë‹¤.

```java
@Override
Optional<Member> findByName(String name);
```

ì˜ˆë¥¼ ë“¤ì–´ ìœ„ì— ì½”ë“œëŠ” **JPQL**ì˜ `select m from Member m where m.name = ?` ë¼ëŠ” ì¿¼ë¦¬ê°€ ì‘ë™í•˜ëŠ” ê²ƒì´ë‹¤.

ê·¸ë¦¬ê³  **ìŠ¤í”„ë§ ë°ì´í„° JPA**ëŠ” **í˜ì´ì§• ê¸°ëŠ¥ë„ ìë™ìœ¼ë¡œ ì œê³µ**í•´ì¤€ë‹¤.

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-24 á„‹á…©á„’á…® 7 39 22](https://github.com/Heo-y-y/SpringConquestRoadmap/assets/112863029/efdecfe1-e51e-4f4e-aa71-1638a5aac13e)

## AOP

### AOPê°€ í•„ìš”í•œ ìƒí™©

- ex) ëª¨ë“  ë©”ì„œë“œì˜ í˜¸ì¶œ ì‹œê°„ì„ ì¸¡ì •í•˜ê³  ì‹¶ì„ ë•Œ
- **ê³µí†µ ê´€ì‹¬ ì‚¬í•­**(cross-cutting concern)ê³¼ **í•µì‹¬ ê´€ì‹¬ ì‚¬í•­**(core concern)ìœ¼ë¡œ ë‚˜ëˆŒ ë•Œ

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-27 á„‹á…©á„’á…® 5 31 36](https://github.com/Heo-y-y/SpringConquestRoadmap/assets/112863029/685178dd-234a-4964-9d85-f02ec9b0f0f7)

ì¦‰, ì•„ë˜ ì½”ë“œì²˜ëŸ¼ MemberService í´ë˜ìŠ¤ì—ì„œ í•µì‹¬ ê¸°ëŠ¥ì´ ì•„ë‹Œ ì‹œê°„ ì¸¡ì • ë¡œì§(ê³µí†µ ë¡œì§)ì„ ì¼ì¼ì´ í•˜ë‚˜ í•˜ë‚˜ ìˆ˜ë°± ê°œë©´ ë‹¤ ì‘ì„±ì„ í•´ì¤˜ì•¼ í•œë‹¤â€¦ ì–¼ë§ˆë‚˜ ë¹„íš¨ìœ¨ì ì¸ê°€â€¦

```java
public Long join(Member member) {
        long start = System.currentTimeMillis();

        try {
        validateDuplicateMember(member);
        memberRepository.save(member);
        return member.getId();

        }finally {
            long finish = System.currentTimeMillis();
            long timeMs = finish - start;
            System.out.println("join = " + timeMs + "ms");
        }
    }
```

ì´ë ‡ê²Œ ë‹¤ ì‘ì„±í•  ê²½ìš° í•µì‹¬ ë¡œì§ê³¼ ê³µí†µ ë¡œì§ì´ ì„ì—¬ ìˆì–´ì„œ ìœ ì§€ ë³´ìˆ˜ê°€ ì–´ë µë‹¤.

ê·¸ë¦¬ê³  ìœ„ì˜ ì‹œê°„ì„ ì¸¡ì •í•˜ëŠ” ë¡œì§ì„ ë³€ê²½í•  ë•Œ ëª¨ë“  ë¡œì§ì„ ì°¾ì•„ê°€ë©´ì„œ ë³€ê²½í•´ì•¼ í•œë‹¤. 

ê·¸ëŸ¬ë©´ **AOP**ë¥¼ í•œë²ˆ ì ìš©í•´ë³´ì.

### AOP ì ìš©

ìš°ì„  **AOP****(Aspect Oriented Programming)ë¥¼ ì„¤ëª…í•˜ìë©´, **ê³µí†µ ê´€ì‹¬ ì‚¬í•­****(cross-cutting concern)ê³¼ **í•µì‹¬ ê´€ì‹¬ ì‚¬í•­**(core concern)ì„ **ë¶„ë¦¬**í•˜ëŠ” ê²ƒì´ë‹¤.

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-27 á„‹á…©á„’á…® 5 32 03](https://github.com/Heo-y-y/SpringConquestRoadmap/assets/112863029/5cb363c4-80ed-488b-967c-9d12e80ab11c)

```java
@Aspect //(1)
@Component //(2)
public class TimeTraceAop {
    @Around("execution(* hello.hellospring..*(..))") //(3)
    public Object execute(ProceedingJoinPoint joinPoint) throws Throwable {
        long start = System.currentTimeMillis();
        System.out.println("START: " + joinPoint.toString());
        try {
            return joinPoint.proceed();
        } finally {
            long finish = System.currentTimeMillis();
            long timeMs = finish - start;
            System.out.println("END: " + joinPoint.toString() +" " + timeMs + "ms");
        }

    }
}
```

(1)ì˜ `@Aspect` ì–´ë…¸í…Œì´ì…˜ì€ ì´ ê¸°ëŠ¥ì´ **ê³µí†µ ê´€ì‹¬ ì‚¬í•­ì´ë¼ê³  ìŠ¤í”„ë§ì—ê²Œ ì•Œë ¤ì£¼ëŠ”** ì–´ë…¸í…Œì´ì…˜ì´ë‹¤.

`@Aspect`ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ **ìŠ¤í”„ë§ ë¹ˆì„ ë“±ë¡í•´ì¤˜ì•¼ í•˜ëŠ”ë°**, ìœ„ ì½”ë“œì˜ (2)ì²˜ëŸ¼ `@Componet`ë¥¼ ì‘ì„±í•´ ë“±ë¡í•´ì¤˜ë„ ë˜ê³ , ì•„ë˜ ì½”ë“œì²˜ëŸ¼ **SpringConfig í´ë˜ìŠ¤ì— ì§ì ‘ ì ìš© ì‹œì¼œì£¼ëŠ” ë°©ë²•**ì´ ìˆë‹¤.

```java
@Bean
    public TimeTraceAop timeTraceAop() {
        return new TimeTraceAop();
    }
```

(3)ì˜ `@Around` ì–´ë…¸í…Œì´ì…˜ì„ ì´ìš©í•´ **AOPì—ì„œ ì¡°ì–¸ ìœ í˜•ì„ ì •ì˜**í•  ìˆ˜ ìˆëŠ”ë°, **ì¦‰ì • ì¡°ì¸ ì§€ì (ë©”ì„œë“œ í˜¸ì¶œê³¼ ê°™ì€ í”„ë¡œê·¸ë¨ ì‹¤í–‰ ì¤‘ íŠ¹ì • ì§€ì )ì—ì„œ ì‹¤í–‰ë˜ëŠ” ì‹¤ì œ ì½”ë“œ**ì´ë‹¤. 

ì´ë ‡ê²Œ ì‘ì„±ì„ í•˜ê³  ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰ ì‹œì¼œì„œ ë™ì‘ì„ ì‹œí‚¤ë©´ ì•„ë˜ ë¡œê·¸ ì²˜ëŸ¼ ì‘ë™ ì‹œ ìœ„ ì½”ë“œì—ì„œ ì‘ì„±í•œ ì‹œê°„ ë¡œì§ì´ ë³´ì—¬ì§€ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. `execution(* hello.hellospring..*(..)` ê°™ì€ ê²½ìš°ì—ëŠ” `@Around`ì˜ ì£¼ì„ìœ¼ë¡œ ì •ì˜ëœ ì¡°ì–¸ì´ ì ìš©ë  ìœ„ì¹˜ë¥¼ ì§€ì •í•˜ëŠ” í¬ì¸íŠ¸ì»· í‘œí˜„ì‹ì´ë‹¤. 

- `hello.hellospring..*`: **ë©”ì†Œë“œê°€ ìœ„ì¹˜í•´ì•¼ í•˜ëŠ” íŒ¨í‚¤ì§€ì™€ í´ë˜ìŠ¤ë¥¼ ì§€ì •**í•˜ëŠ” ë¶€ë¶„ì´ë‹¤.
- `.*(..)`: **ë©”ì†Œë“œ ì‹œê·¸ë‹ˆì²˜ë¥¼ ì§€ì •**í•˜ëŠ” ë¶€ë¶„ì¸ë°, `*`ëŠ” ë©”ì†Œë“œì´ë¦„, `(..)`ì€ ëª¨ë“  ìœ í˜•ì˜ ë§¤ê°œë³€ìˆ˜ ìˆ˜ ì´ë‹¤.

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-27 á„‹á…©á„’á…® 5 59 14](https://github.com/Heo-y-y/SpringConquestRoadmap/assets/112863029/533d7d59-b1d8-4698-9407-3ed345c9ecd8)

- ì¥ì 
    - í•µì‹¬ ê´€ì‹¬ ì‚¬í•­ë§Œì„ ë³´ê¸° ì¢‹ê²Œ ì½”ë“œë¥¼ ìœ ì§€í•  ìˆ˜ ìˆë‹¤.
    - ë³€ê²½ì´ í•„ìš”í•˜ë©´ í•´ë‹¹ ë¡œì§ë§Œ ë³€ê²½í•˜ë©´ ëœë‹¤.
    - ì›í•˜ëŠ” ëŒ€ìƒì— ì ìš©í•  ìˆ˜ ìˆë‹¤.

### ìŠ¤í”„ë§ AOPì˜ ë™ì‘ ë°©ì‹

- **AOP ì ìš© ì „ ì˜ì¡´ê´€ê³„ ë° ì „ì²´ ê·¸ë¦¼**

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-27 á„‹á…©á„’á…® 5 51 53](https://github.com/Heo-y-y/SpringConquestRoadmap/assets/112863029/f0b94f01-7e99-4abe-a5d9-b37e53cd1a0f)

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-27 á„‹á…©á„’á…® 5 54 30](https://github.com/Heo-y-y/SpringConquestRoadmap/assets/112863029/48c889ee-7b26-4c9b-93cf-8781695b6b21)

- **AOP ì ìš© í›„ ì˜ì¡´ê´€ê³„ ë° ì „ì²´ ê·¸ë¦¼**

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-27 á„‹á…©á„’á…® 5 52 31](https://github.com/Heo-y-y/SpringConquestRoadmap/assets/112863029/3143c669-0d17-4dec-a9db-d235777e29de)

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-27 á„‹á…©á„’á…® 5 53 32](https://github.com/Heo-y-y/SpringConquestRoadmap/assets/112863029/de1cfb76-6b52-4cdf-af22-5260ff0f61c0)

ìŠ¤í”„ë§ **AOP**ë¥¼ ì‚¬ìš©í•˜ë©´ **ê°€ì§œ memberServiceë¥¼ ë§Œë“¤ì–´ ë‚¸ë‹¤(í”„ë¡ì‹œ)**. ì»¨í…Œì´ë„ˆì— ìŠ¤í”„ë§ ë¹ˆì„ ë“±ë¡í•  ë•Œ ì§„ì§œ ìŠ¤í”„ë§ ë¹ˆ ë§ê³ , **ê°€ì§œ ìŠ¤í”„ë§ ë¹ˆ**ì„ ì•ì— ì„¸ì›Œ ë‘”ë‹¤. 

ê·¸ë¦¬ê³  ê°€ì§œ ìŠ¤í”„ë§ ë¹ˆì´ ëë‚˜ë©´, ê·¸ë•Œ ì§„ì§œ memberServiceë¥¼ í˜¸ì¶œí•´ì¤€ë‹¤. ì¦‰, **helloControllerê°€ í˜¸ì¶œí•˜ëŠ” ê²ƒì€** ì§„ì§œ memberServiceê°€ ì•„ë‹ˆë¼ **í”„ë¡ì‹œë¡œ ë°œìƒí•˜ëŠ” ê°€ì§œ memberService**ì´ë‹¤.

**ì°¸ê³ ìë£Œ**

- [https://www.inflearn.com/course/ìŠ¤í”„ë§-ì…ë¬¸-ìŠ¤í”„ë§ë¶€íŠ¸/dashboard](https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81-%EC%9E%85%EB%AC%B8-%EC%8A%A4%ED%94%84%EB%A7%81%EB%B6%80%ED%8A%B8/dashboard)
